/*! BestForMe 15-11-2017 */
console.log(Backbone.LocalStorage);var BestForMe=Backbone.Marionette.Application.extend({appData:{apiBaseUrl:null,endpoints:{ee:null,three:null,vodafone:null,o2:null,ofcom:null},data:{user:null,dash:null,article:null,pathways:null,news:null,statistics:null,banners:null,dock:null,notifications:null,acknowledgements:null,footer:null,search:{collection:null,query:null}},features:{statistics:!1,dock:!1,dash:!1,banner:!1},modules:{engage:!1,pathways:!1,bestforme:!1},localMode:!1,token:null,tokenBearerHeader:null,debug:!1,title:null,errorMessage:{0:"The server could not be reached. Please wait 30 seconds and try to reload the page.",500:"The server could not be reached. Please wait 30 seconds and try to reload the page.",503:"The server could not be reached. Please wait 30 seconds and try to reload the page.",504:"The server could not be reached. Please wait 30 seconds and try to reload the page.",404:"The page you requested could not be found.",400:"There is a problem with this version of the app. Please contact technical support."},rootHomePage:"home"},authData:{clientCredentials:null,login:null,tokenEndpoint:null,userEndpoint:null,passwordEndpoint:null,passwordReset:null},auth:null,dataManager:null,routerController:null,router:null,authChannel:null,dataChannel:null,routerChannel:null,redirectTo:{pathname:null,hash:null},initialize:function(a){"false"===a.debug&&(console.log=function(){}),console.log("BestForMe.INIT href: "+window.location.href+" pathname: "+window.location.pathname+" hash: "+window.location.hash),this.initAppData(a),this.dataChannel=Backbone.Radio.channel("data"),this.routerChannel=Backbone.Radio.channel("router"),this.listenTo(this.routerChannel,"navigate:to:page",this.navigateToPage),this.listenTo(this.routerChannel,"route:executed",this.onRouteExecuted),this.dataManager=new BestForMe.DataManager({appData:this.appData}),this.routerController=new BestForMe.RouterController({authData:this.authData,appData:this.appData}),this.router=new BestForMe.Router({appData:this.appData,controller:this.routerController})},initAppData:function(a){"true"===a.features.localMode?(this.appData.localMode=!0,this.appData.apiBaseUrl="/data"):(this.appData.localMode=!1,this.appData.apiBaseUrl=a.baseUrl),this.appData.endpoints.ee=a.eeEndpoint,this.appData.endpoints.three=a.threeEndpoint,this.appData.endpoints.vodafone=a.vodafoneEndpoint,this.appData.endpoints.o2=a.o2Endpoint,this.appData.endpoints.ofcom=a.ofcomEndpoint,this.appData.title=a.title,this.appData.debug=a.debug,"true"===a.features.footer?this.appData.features.footer=!0:this.appData.features.footer=!1,this.appData.modules.bestforme=!0},onStart:function(){console.log("BestForMe.START href: "+window.location.href+" pathname: "+window.location.pathname+" hash: "+window.location.hash),console.log("LOCALMODE: "+this.appData.localMode),this.detectUniversalLinks(),this.detectUrl(),Backbone.history.start({pushState:!0}),this.appData.localMode&&this.bypassAuth()},detectUrl:function(){console.log("BestForMe.detectUrl href: "+window.location.href+" pathname: "+window.location.pathname+" hash: "+window.location.hash),window.location.pathname&&"/"!==window.location.pathname&&!window.location.pathname.match(/login/)&&(this.redirectTo.pathname=window.location.pathname),window.location.hash&&!window.location.hash.match(/login/)&&(this.redirectTo.hash=window.location.hash),console.log(JSON.stringify(this.redirectTo))},findGetParameter:function(a){var b=null,c=[];return location.search.substr(1).split("&").forEach(function(d){c=d.split("="),c[0]===a&&(b=decodeURIComponent(c[1]))}),b},onLoginRequired:function(){console.log("App.onLoginRequired"),this.redirectTo.pathname&&this.redirectTo.pathname.match(/reset-password/)||this.redirectTo.hash&&this.redirectTo.hash.match(/reset-password/)?this.redirectToPage(!1):this.router.navigate("login",{trigger:!0})},onLoginInvalid:function(a){console.log("App.onLoginInvalid: "+a),this.detectUrl(),this.router.navigate("login",{trigger:!0})},onLogOut:function(){console.log("App.onLogOut"),this.auth.onLogOut(),this.dataManager.clearData(),this.router.navigate("login",{trigger:!0})},onAuthComplete:function(){console.log("App.onAuthComplete: "+JSON.stringify(this.appData.tokenBearerHeader)),this.dataManager.fetchData(),this.routerController.forceInitialRender(),this.router.navigate("loading",{trigger:!0})},bypassAuth:function(){console.log("App.bypassAuth"),this.dataManager.fetchData(),this.routerController.forceInitialRender(),this.router.navigate("loading",{trigger:!0})},onTokenUpdated:function(){console.log("App.onTokenUpdated: "+JSON.stringify(this.appData.tokenBearerHeader)),this.redirectToPage(!1)},onDataFetchError:function(a){if(console.log("App.onDataFetchError: "+JSON.stringify(a)),"login"===a.action)this.router.navigate("login",{trigger:!0});else if("error"===a.action){var b="error/"+a.errorCode;this.router.navigate(b,{trigger:!0})}else"message"!==a.action||500!==a.errorCode&&503!==a.errorCode&&504!==a.errorCode&&0!==a.errorCode||this.routerChannel.trigger("server:down")},onDataFetched:function(){console.log("App.onDataFetched"),this.router.onDataFetched(),this.routerController.forceInitialRender(),this.redirectToPage(!0)},onMissingData:function(a){console.log("App.onHideMissingData: "+a),"statistics"===a?this.appData.features.statistics=!1:"dock"===a&&(this.appData.features.dock=!1)},clearRedirect:function(){console.log("BestForMe.clearRedirect: "+JSON.stringify(this.redirectTo)),this.redirectTo.pathname=null,this.redirectTo.hash=null},onRouteExecuted:function(a){console.log("App.onRouteExecuted: "+a+", redirect: "+JSON.stringify(this.redirectTo)),this.auth.initialAuthCompleted&&(this.redirectTo.pathname&&this.redirectTo.pathname.match(a)||this.redirectTo.hash&&this.redirectTo.hash.match(a))&&(console.log("CLEAR REDIRECT MATCH"),this.clearRedirect())},redirectToPage:function(a){this.redirectTo.pathname?(console.log("App.redirectToPage REDIRECT TO PATHNAME: "+this.redirectTo.pathname),this.router.navigate(this.redirectTo.pathname,{trigger:!0})):this.redirectTo.hash?(console.log("App.redirectToPage REDIRECT TO HASH: "+this.redirectTo.hash),this.router.navigate(this.redirectTo.hash,{trigger:!0})):a&&this.router.navigate(this.appData.rootHomePage,{trigger:!0})},navigateToPage:function(a,b,c,d){console.log("App.navigateToPage: "+a+" "+b+" "+d);var e=a;b&&("/"!==e.slice(-1)&&(e+="/"),e+=b),c&&(e+="/"+c),d&&(e+="/"+d),this.router.navigate(e,{trigger:!0})},onPasswordResetClearRedirect:function(){this.clearRedirect(),this.router.navigate("login",{trigger:!0})}});!function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}return"function"!=typeof window.CustomEvent&&(a.prototype=window.Event.prototype,void(window.CustomEvent=a))}(),BestForMe.LocalStoreManager=function(){function a(){var a=this;this.syncKeys=[],this.reservedKeys=["sync_keys","addToSyncKeys","removeFromSyncKeys","getSessionStorage","setSessionStorage","addToSessionStorage","removeFromSessionStorage","clearAllSessionsStorage","raiseDBEvent"],this.localStorageSupported=!1,this.sessionStorageTransferHandler=function(b){if(b.newValue)if("getSessionStorage"==b.key)sessionStorage.length&&a.localStorageSupported&&(localStorage.setItem("setSessionStorage",JSON.stringify(sessionStorage)),localStorage.removeItem("setSessionStorage"));else if("setSessionStorage"==b.key)a.setSessionStorageHelper(b.newValue);else if("addToSessionStorage"==b.key){var c=JSON.parse(b.newValue);a.addToSessionStorageHelper(c.data,c.key)}else"removeFromSessionStorage"==b.key?a.removeFromSessionStorageHelper(b.newValue):"clearAllSessionsStorage"==b.key&&sessionStorage.length?a.clearInstanceSessionStorage():"addToSyncKeys"==b.key?a.addToSyncKeysHelper(b.newValue):"removeFromSyncKeys"==b.key&&a.removeFromSyncKeysHelper(b.newValue)}}return a.prototype.isLocalStorageSupported=function(){try{return localStorage.setItem("test",1),localStorage.removeItem("test"),!0}catch(a){return!1}},a.prototype.initialiseStorageSyncListener=function(){console.log("LocalStoreManager.initialiseStorageSyncListener: "+a.syncListenerInitialised),1!=a.syncListenerInitialised&&(a.syncListenerInitialised=!0,this.localStorageSupported=this.isLocalStorageSupported(),console.log("LOCAL STORAGE SUPPORTED ? "+this.localStorageSupported),window.addEventListener("storage",this.sessionStorageTransferHandler,!1),this.syncSessionStorage())},a.prototype.deinitialiseStorageSyncListener=function(){window.removeEventListener("storage",this.sessionStorageTransferHandler,!1),a.syncListenerInitialised=!1},a.prototype.setSessionStorageHelper=function(a){this.syncKeys.length||this.loadSyncKeys();var b=JSON.parse(a),c=[];for(var d in b)this.syncKeysContains(d)&&(this.localStorageSupported&&sessionStorage.setItem(d,b[d]),c.push(d));var e=new CustomEvent("sessionStorageSet",{detail:c});window.dispatchEvent(e)},a.prototype.syncSessionStorage=function(){this.localStorageSupported&&(localStorage.setItem("getSessionStorage","_dummy"),localStorage.removeItem("getSessionStorage"))},a.prototype.clearAllStorage=function(){this.clearAllSessionsStorage(),this.clearLocalStorage()},a.prototype.clearAllSessionsStorage=function(){this.clearInstanceSessionStorage(),this.localStorageSupported&&(localStorage.removeItem(a.DBKEY_SYNC_KEYS),localStorage.setItem("clearAllSessionsStorage","_dummy"),localStorage.removeItem("clearAllSessionsStorage"))},a.prototype.clearInstanceSessionStorage=function(){this.localStorageSupported&&sessionStorage.clear(),this.syncKeys=[]},a.prototype.clearLocalStorage=function(){this.localStorageSupported&&localStorage.clear()},a.prototype.addToSessionStorage=function(a,b){console.log("localStoreManager.addToSessionStorage: "+b),this.addToSessionStorageHelper(a,b),this.addToSyncKeysBackup(b),this.localStorageSupported&&(localStorage.setItem("addToSessionStorage",JSON.stringify({key:b,data:a})),localStorage.removeItem("addToSessionStorage"))},a.prototype.addToSessionStorageHelper=function(a,b){this.addToSyncKeysHelper(b),this.localStorageSupported&&sessionStorage.setItem(b,a)},a.prototype.removeFromSessionStorage=function(a){this.removeFromSessionStorageHelper(a),this.removeFromSyncKeysBackup(a),this.localStorageSupported&&(localStorage.setItem("removeFromSessionStorage",a),localStorage.removeItem("removeFromSessionStorage"))},a.prototype.removeFromSessionStorageHelper=function(a){this.localStorageSupported&&sessionStorage.removeItem(a),this.removeFromSyncKeysHelper(a)},a.prototype.testForInvalidKeys=function(a){if(!a)throw new Error("key cannot be empty");if(this.reservedKeys.some(function(b){return b==a}))throw new Error('The storage key "'+a+'" is reserved and cannot be used. Please use a different key')},a.prototype.syncKeysContains=function(a){return this.syncKeys.some(function(b){return b==a})},a.prototype.loadSyncKeys=function(){this.syncKeys.length||(this.syncKeys=this.getSyncKeysFromStorage())},a.prototype.getSyncKeysFromStorage=function(b){void 0===b&&(b=[]);var c=localStorage.getItem(a.DBKEY_SYNC_KEYS);return null==c?b:JSON.parse(c)},a.prototype.addToSyncKeys=function(a){this.addToSyncKeysHelper(a),this.addToSyncKeysBackup(a),this.localStorageSupported&&(localStorage.setItem("addToSyncKeys",a),localStorage.removeItem("addToSyncKeys"))},a.prototype.addToSyncKeysBackup=function(b){var c=this.getSyncKeysFromStorage();c.some(function(a){return a==b})||(c.push(b),this.localStorageSupported&&localStorage.setItem(a.DBKEY_SYNC_KEYS,JSON.stringify(c)))},a.prototype.removeFromSyncKeysBackup=function(b){var c=this.getSyncKeysFromStorage(),d=c.indexOf(b);d>-1&&(c.splice(d,1),this.localStorageSupported&&localStorage.setItem(a.DBKEY_SYNC_KEYS,JSON.stringify(c)))},a.prototype.addToSyncKeysHelper=function(a){this.syncKeysContains(a)||this.syncKeys.push(a)},a.prototype.removeFromSyncKeys=function(a){this.removeFromSyncKeysHelper(a),this.removeFromSyncKeysBackup(a),this.localStorageSupported&&(localStorage.setItem("removeFromSyncKeys",a),localStorage.removeItem("removeFromSyncKeys"))},a.prototype.removeFromSyncKeysHelper=function(a){var b=this.syncKeys.indexOf(a);b>-1&&this.syncKeys.splice(b,1)},a.prototype.saveSessionData=function(b,c){void 0===c&&(c=a.DBKEY_USER_DATA),this.testForInvalidKeys(c),this.removeFromSyncKeys(c),this.localStorageSupported&&(localStorage.removeItem(c),sessionStorage.setItem(c,b))},a.prototype.saveSyncedSessionData=function(b,c){void 0===c&&(c=a.DBKEY_USER_DATA),this.testForInvalidKeys(c),this.localStorageSupported&&localStorage.removeItem(c),this.addToSessionStorage(b,c)},a.prototype.savePermanentData=function(b,c){console.log("localStoreManager.savePermanentData: "+c),void 0===c&&(c=a.DBKEY_USER_DATA),this.testForInvalidKeys(c),this.removeFromSessionStorage(c),this.localStorageSupported&&localStorage.setItem(c,b)},a.prototype.getData=function(b){void 0===b&&(b=a.DBKEY_USER_DATA),this.testForInvalidKeys(b);var c=null;return this.localStorageSupported&&(c=sessionStorage.getItem(b),console.log("LocalStoreManager.getData TRY SESSION STORAGE"+b),console.log(c),null==c&&(c=localStorage.getItem(b),console.log("LocalStoreManager.getData TRY LOCAL STORAGE"+b),console.log(c))),c},a.prototype.getDataObject=function(b){void 0===b&&(b=a.DBKEY_USER_DATA);var c=this.getData(b);return console.log(c),null!=c?JSON.parse(c):null},a.prototype.deleteData=function(b){void 0===b&&(b=a.DBKEY_USER_DATA),this.testForInvalidKeys(b),this.removeFromSessionStorage(b),this.localStorageSupported&&localStorage.removeItem(b)},a}(),BestForMe.LocalStoreManager.syncListenerInitialised=!1,BestForMe.LocalStoreManager.DBKEY_USER_DATA="user_data",BestForMe.LocalStoreManager.DBKEY_SYNC_KEYS="sync_keys",Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(a,b){function c(a,b){return a===b||"number"==typeof a&&"number"==typeof b&&isNaN(a)&&isNaN(b)}if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return!1;for(var f=0|b,g=Math.max(f>=0?f:e-Math.abs(f),0);g<e;){if(c(d[g],a))return!0;g++}return!1}}),BestForMe.ErrorHandlerMixin={handleError:function(a,b,c){console.log("handleError RESPONSE"),console.log(a),b&&(console.log("handleError OPTIONS"),console.log(b));var d={errorCode:0,errorMessage:"",action:null};if(a.status&&(d.errorCode=a.status),200===d.errorCode?(d.action="silent",d.errorMessage+="Success."):500===d.errorCode||503===d.errorCode||504===d.errorCode||0===d.errorCode?(d.action="message",d.errorMessage+=this.appData.errorMessage[d.errorCode]):404===d.errorCode?(d.action="error",d.errorMessage+=this.appData.errorMessage[d.errorCode]):403===d.errorCode?(d.action="message",d.errorMessage+="You do not have sufficient permission to perform this action."):401===d.errorCode?(d.action="login",b.data&&b.data.match(/grant_type=password/)?d.errorMessage+="Invalid username and password combination. Please try log in again.":d.errorMessage+="Your login has expired. Please try log in again."):400===d.errorCode&&(b.data&&b.data.match(/grant_type=refresh_token/)?(d.action="login",d.errorMessage+="Your login has expired. Please try log in again."):b.data&&(b.data.match(/grant_type=password/)||b.data.match(/grant_type=client_credentials/))?(d.action="error",d.errorMessage+=this.appData.errorMessage[d.errorCode]):(d.action="message",d.errorMessage+="There was a problem handling your request. Please contact technical support if problems persist.")),console.log("ERROR"),console.log(d),c)if("error"===d.action||"login"===d.action)if(this.dataChannel)console.log("ROUTE DIRECTLY FROM ERROR HANDLER USING dataChannel  IN SCOPE"),this.dataChannel.trigger("data:fetch:error",d);else{console.log("ROUTE DIRECTLY FROM ERROR HANDLER USING OWN dataChannel");var e=Backbone.Radio.channel("data");e.trigger("data:fetch:error",d)}else"message"===d.action&&(console.log("SWAL DIRECTLY FROM ERROR HANDLER"),swal(d.errorMessage));return d}},BestForMe.LocalStorageMixin={fetchLocalStorage:function(){this instanceof Backbone.Collection,this instanceof Backbone.Model;if(this instanceof Backbone.Model){var a=localStorage.getItem(this.cid);return!!a&&(this.set(JSON.parse(a)),this)}},saveLocalStorage:function(){localStorage.setItem(this.cid,JSON.stringify(this.toJSON()))},destroyLocalStorage:function(){localStorage.removeItem(this.cid)}},BestForMe.ChangeTitleMixin={changePageTitle:function(a,b){console.log(a+" - "+b);var c=null;c=a===b?a:b+" - "+a,document.title=c}},BestForMe.RemoveTemplateWrapperBehavior=Backbone.Marionette.Behavior.extend({onRender:function(){1===this.view.el.childElementCount&&(this.view.$el=this.view.$el.children(),this.view.$el.unwrap(),this.view.setElement(this.view.$el))}}),BestForMe.InternalLinkBehavior=Marionette.Behavior.extend({ui:{link:"a"},events:{"click @ui.link":"onLinkClicked"},onLinkClicked:function(a){if($(a.currentTarget).attr("href")&&$(a.currentTarget).attr("href").match(/^\//)){a.stopPropagation(),a.preventDefault();var b=a.currentTarget.pathname;if(console.log("InternalLinkBehavior.onLinkClicked INTERNAL LINK: "+b),this.view.routerChannel)this.view.routerChannel.trigger("navigate:to:page",b);else{var c=Backbone.Radio.channel("router");c.trigger("navigate:to:page",b)}}}}),BestForMe.LogoutBehavior=Marionette.Behavior.extend({ui:{logout:".logout"},events:{"click @ui.logout":"onClickLogout"},onClickLogout:function(){if(this.view.authChannel)var a=this.view.authChannel;else var a=Backbone.Radio.channel("auth");swal({title:"Are you sure you would like to log out?",type:"warning",showCancelButton:!0,confirmButtonText:"Log Out",closeOnConfirm:!0},function(){a.trigger("log:out")})}}),BestForMe.PaginationBehavior=Backbone.Marionette.Behavior.extend({ui:{goToPage:".pagination-link"},events:{"click @ui.goToPage":"goToPage"},pagination:{dotsPrevious:0,previous:0,current:0,next:0,dotsNext:0,total:0,showTotal:0,showFirst:0},onBeforeRender:function(){this.makePagination()},goToPage:function(a){var b=a.currentTarget.dataset.page;this.view.goToPage(b)},clearPagination:function(){this.pagination.dotsPrevious=0,this.pagination.previous=0,this.pagination.current=0,this.pagination.next=0,this.pagination.dotsNext=0,this.pagination.total=0,this.pagination.showTotal=0,this.pagination.showFirst=0},makePagination:function(){this.view.pagination=this.pagination,this.clearPagination(),this.view.collection&&this.view.collection.totalLength>this.view.collection.pageLength&&(this.pagination.current=parseInt(this.view.collection.page),this.pagination.total=Math.ceil(this.view.collection.totalLength/this.view.collection.perPage),this.pagination.showTotal=1,this.pagination.current>2&&(this.pagination.showFirst=1),this.pagination.current>1&&(this.pagination.previous=this.pagination.current-1,this.pagination.previous>2&&(this.pagination.dotsPrevious=!0)),this.pagination.total-this.pagination.current>1&&(this.pagination.next=this.pagination.current+1,this.pagination.total-this.pagination.next>1&&(this.pagination.dotsNext=!0)),this.pagination.total!==this.pagination.current&&this.pagination.total!==this.pagination.next||(this.pagination.showTotal=0))}}),BestForMe.ClientCredentials=Backbone.Model.extend({defaults:{clientId:"",clientSecret:""}}),BestForMe.UserLogin=Backbone.Model.extend({defaults:{username:"",password:""}}),BestForMe.Token=Backbone.Model.extend({apiUrl:null,url:function(){return this.apiUrl},defaults:{accessToken:"",expiresIn:"",tokenType:"",scope:"",refreshToken:"",expiryDate:""},initialize:function(a,b){this.apiUrl=b.url},parse:function(a,b){console.log("token.parse options: "+JSON.stringify(b)+", response: "+JSON.stringify(a));var c={accessToken:a.access_token,expiresIn:a.expires_in,tokenType:a.token_type,scope:a.scope,refreshToken:a.refresh_token,expiryDate:this._calcExpiryDate(a.expires_in)};return c},_calcExpiryDate:function(a){return Date.now()+1e3*a},isValid:function(){var a=this.get("expiryDate")-Date.now(),b=a>0;return console.log("token.isValid: "+this.get("accessToken")+" still valid? "+b+" for "+a+" ms"),b}}),BestForMe.PasswordResetRequest=Backbone.Model.extend({defaults:{identifier:""},apiUrl:null,url:function(){return this.apiUrl},initialize:function(a,b){this.apiUrl=b.userBaseUrl+"/reset-password"}}),BestForMe.PasswordReset=Backbone.Model.extend({defaults:{username:"",password:"",resetKey:"",id:1},apiUrl:null,url:function(){return this.apiUrl},initialize:function(a,b){this.apiUrl=b.url}}),BestForMe.PasswordChange=Backbone.Model.extend({defaults:{oldPassword:"",password:"",id:1},apiUrl:null,url:function(){return this.apiUrl},initialize:function(a,b){this.apiUrl=b.url}}),BestForMe.User=Backbone.Model.extend({defaults:{message:"",firstName:"",lastName:"",nickName:"",username:"",userId:0,email:"",permissions:"",location:"",avatar:"",powers:""},apiUrl:null,isAdmin:!1,editArticles:!1,editNews:!1,url:function(){return this.apiUrl},initialize:function(a,b){this.apiUrl=b.url},parse:function(a,b){var c={message:a.result.message,firstName:a.result.first_name,lastName:a.result.last_name,nickName:a.result.nick_name,username:a.result.username,userId:a.result.user_id,email:a.result.email,color:a.result.color,permissions:a.result.permissions,location:a.result.location,avatar:a.result.avatar,powers:a.result.powers};return c.powers.includes("op_edit_admin")||c.powers.includes("manage_articles")?this.isAdmin=!0:this.isAdmin=!1,c.powers.includes("op_edit_admin")?this.editNews=!0:this.editNews=!1,c.powers.includes("manage_articles")?this.editArticles=!0:this.editArticles=!1,c}}),this.BestForMe=this.BestForMe||{},this.BestForMe.Templates=this.BestForMe.Templates||{},this.BestForMe.Templates["agility/canvas-grid-item"]=Handlebars.template({1:function(a,b,c,d,e){return" disabled"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<li class="canvas-hex" id="'+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,typeof g===j?g.call(h,{name:"id",hash:{},data:e}):g))+'">\n  <div class="hex-in">\n    <a class="hex-link '+k((g=null!=(g=c.hexType||(null!=b?b.hexType:b))?g:i,typeof g===j?g.call(h,{name:"hexType",hash:{},data:e}):g))+"\">\n      <span class='hex-bg "+k((g=null!=(g=c.type||(null!=b?b.type:b))?g:i,typeof g===j?g.call(h,{name:"type",hash:{},data:e}):g))+(null!=(f=c.if.call(h,null!=b?b.disabled:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"'></span>\n      <h1>"+k((g=null!=(g=c.title||(null!=b?b.title:b))?g:i,typeof g===j?g.call(h,{name:"title",hash:{},data:e}):g))+"</h1>\n    </a>\n  </div>\n</li>"},useData:!0}),this.BestForMe.Templates["agility/canvas-tray-item"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression,l=a.lambda;return'<li class="solution-hex" id="'+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,typeof g===j?g.call(h,{name:"id",hash:{},data:e}):g))+'">\n  <div class="hex-in">\n    <div class="hex-link '+k((g=null!=(g=c.hexType||(null!=b?b.hexType:b))?g:i,typeof g===j?g.call(h,{name:"hexType",hash:{},data:e}):g))+"\">\n\n      <span class='hex-bg "+k((g=null!=(g=c.displayClass||(null!=b?b.displayClass:b))?g:i,typeof g===j?g.call(h,{name:"displayClass",hash:{},data:e}):g))+'\'></span>\n      <p class="hex-title">'+k((g=null!=(g=c.type||(null!=b?b.type:b))?g:i,typeof g===j?g.call(h,{name:"type",hash:{},data:e}):g))+'</p>\n      <div class="tab">\n        <button class="tablinks solution-tab-button">Solution</button>\n        <button class="tablinks impact-tab-button">Impact</button>\n      </div>\n\n      <div class="solution-tab tab-content">\n        <h1>'+k((g=null!=(g=c.description||(null!=b?b.description:b))?g:i,typeof g===j?g.call(h,{name:"description",hash:{},data:e}):g))+'</h1>\n      </div>\n\n      <div class="impact-tab tab-content">\n\n        <div class="impact-element no-edit">\n          <p class="impact-title">Cost</p>\n          <p class="impact-value">'+k(l(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.cost:f,b))+'</p>\n        </div>\n\n        <div class="impact-element no-edit">\n          <p class="impact-title">Quality</p>\n          <p class="impact-value">'+k(l(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.quality:f,b))+'</p>\n        </div>\n\n        <div class="impact-element no-edit">\n          <p class="impact-title">Time</p>\n          <p class="impact-value">'+k(l(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.time:f,b))+'</p>\n        </div>\n\n        <div class="impact-element no-edit">\n          <p class="impact-title">Sustainability</p>\n          <p class="impact-value">'+k(l(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.sustainability:f,b))+"</p>\n        </div>\n        \n      </div>\n\n    </div>\n  </div>\n</li>\n"},useData:!0}),this.BestForMe.Templates["agility/canvas-tray-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<h2>Technical Solutions</h2>\n<ul class="solution-list">\n</ul>'},useData:!0}),this.BestForMe.Templates["agility/canvas-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section id="canvas-tray">\n</section>\n<section id="canvas-collection" class="canvas-collection">\n</section>\n<section id="canvas-filter">\n</section>'},useData:!0}),this.BestForMe.Templates["agility/solution-grid-item-input"]=Handlebars.template({1:function(a,b,c,d,e){return" disabled"},3:function(a,b,c,d,e){var f,g,h=null!=b?b:{};return'          <textarea class="solution-input" rows="2">'+a.escapeExpression((g=null!=(g=c.title||(null!=b?b.title:b))?g:c.helperMissing,"function"==typeof g?g.call(h,{name:"title",hash:{},data:e}):g))+'</textarea>\n          <div class="hex-buttons">\n'+(null!=(f=c.if.call(h,null!=b?b.dataId:b,{name:"if",hash:{},fn:a.program(4,e,0),inverse:a.program(6,e,0),data:e}))?f:"")+"          </div>\n"},4:function(a,b,c,d,e){return'              <button class="hex-edit-confirm">Confirm</button>\n              <button class="hex-edit-cancel">Cancel</button>\n'},6:function(a,b,c,d,e){return'              <button class="hex-new-confirm">Confirm</button>\n              <button class="hex-new-cancel">Cancel</button>\n'},8:function(a,b,c,d,e){var f;return"          <h1>"+a.escapeExpression((f=null!=(f=c.title||(null!=b?b.title:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"title",hash:{},data:e}):f))+'</h1>\n          <div class="hex-buttons">\n            <button class="hex-edit">Edit</button>\n            <button class="hex-delete">Delete</button>\n          </div>\n'},10:function(a,b,c,d,e){return" no-edit"},12:function(a,b,c,d,e){var f;return'            <input class="impact-input cost-input" type="range" step="1" min="1" max="5" list="tickmarks-cost" '+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.dataId:b,{name:"if",hash:{},fn:a.program(13,e,0),inverse:a.noop,data:e}))?f:"")+'>\n            <datalist id="tickmarks-cost">\n              <option value="1" label="Low">\n              <option value="2">\n              <option value="3">\n              <option value="4">\n              <option value="5" label="High">\n              </datalist>\n'},13:function(a,b,c,d,e){var f;return'value="'+a.escapeExpression(a.lambda(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.cost:f,b))+'"'},15:function(a,b,c,d,e){var f;return'            <p class="impact-value">'+a.escapeExpression(a.lambda(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.cost:f,b))+"</p>\n"},17:function(a,b,c,d,e){var f;return'            <input class="impact-input quality-input" type="range" step="1" min="1" max="5" list="tickmarks-quality" '+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.dataId:b,{name:"if",hash:{},fn:a.program(18,e,0),inverse:a.noop,data:e}))?f:"")+'>\n            <datalist id="tickmarks-quality">\n              <option value="1" label="Low">\n              <option value="2">\n              <option value="3">\n              <option value="4">\n              <option value="5" label="High">\n            </datalist>\n'},18:function(a,b,c,d,e){var f;return'value="'+a.escapeExpression(a.lambda(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.quality:f,b))+'"'},20:function(a,b,c,d,e){var f;return'            <p class="impact-value">'+a.escapeExpression(a.lambda(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.quality:f,b))+"</p>\n"},22:function(a,b,c,d,e){var f;return'            <input class="impact-input time-input" type="range" step="1" min="1" max="5" list="tickmarks-time" '+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.dataId:b,{name:"if",hash:{},fn:a.program(23,e,0),inverse:a.noop,data:e}))?f:"")+'>\n            <datalist id="tickmarks-time">\n              <option value="1" label="Low">\n              <option value="2">\n              <option value="3">\n              <option value="4">\n              <option value="5" label="Most">\n            </datalist>\n'},23:function(a,b,c,d,e){var f;return'value="'+a.escapeExpression(a.lambda(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.time:f,b))+'"'},25:function(a,b,c,d,e){var f;return'            <p class="impact-value">'+a.escapeExpression(a.lambda(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.time:f,b))+"</p>\n"},27:function(a,b,c,d,e){var f;return'            <input class="impact-input sustain-input" type="range" step="1" min="1" max="5" list="tickmarks-sustainability" '+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.dataId:b,{name:"if",hash:{},fn:a.program(28,e,0),inverse:a.noop,data:e}))?f:"")+'>\n            <datalist id="tickmarks-sustainability">\n              <option value="1" label="Low">\n              <option value="2">\n              <option value="3">\n              <option value="4">\n              <option value="5" label="High">\n            </datalist>\n'},28:function(a,b,c,d,e){var f;return'value="'+a.escapeExpression(a.lambda(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.sustainability:f,b))+'"'},30:function(a,b,c,d,e){var f;return'            <p class="impact-value">'+a.escapeExpression(a.lambda(null!=(f=null!=(f=null!=b?b.impact:b)?f.attributes:f)?f.sustainability:f,b))+"</p>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<li class="solution-hex" id="'+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,typeof g===j?g.call(h,{name:"id",hash:{},data:e}):g))+'">\n  <div class="hex-in">\n    <div class="hex-link '+k((g=null!=(g=c.hexType||(null!=b?b.hexType:b))?g:i,typeof g===j?g.call(h,{name:"hexType",hash:{},data:e}):g))+"\">\n\n      <span class='hex-bg "+k((g=null!=(g=c.type||(null!=b?b.type:b))?g:i,typeof g===j?g.call(h,{name:"type",hash:{},data:e}):g))+(null!=(f=c.if.call(h,null!=b?b.disabled:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'\'></span>\n      <div class="tab">\n        <button class="tablinks solution-tab-button">Solution</button>\n        <button class="tablinks impact-tab-button">Impact</button>\n      </div>\n\n      <div class="solution-tab tab-content">\n'+(null!=(f=c.if.call(h,null!=b?b.edit:b,{name:"if",hash:{},fn:a.program(3,e,0),inverse:a.program(8,e,0),data:e}))?f:"")+'      </div>\n\n      <div class="impact-tab tab-content">\n\n        <div class="impact-element'+(null!=(f=c.unless.call(h,null!=b?b.edit:b,{name:"unless",hash:{},fn:a.program(10,e,0),inverse:a.noop,data:e}))?f:"")+'">\n          <p class="impact-title">Cost</p>\n'+(null!=(f=c.if.call(h,null!=b?b.edit:b,{name:"if",hash:{},fn:a.program(12,e,0),inverse:a.program(15,e,0),data:e}))?f:"")+'        </div>\n\n        <div class="impact-element'+(null!=(f=c.unless.call(h,null!=b?b.edit:b,{name:"unless",hash:{},fn:a.program(10,e,0),inverse:a.noop,data:e}))?f:"")+'">\n          <p class="impact-title">Quality</p>\n'+(null!=(f=c.if.call(h,null!=b?b.edit:b,{name:"if",hash:{},fn:a.program(17,e,0),inverse:a.program(20,e,0),data:e}))?f:"")+'        </div>\n\n        <div class="impact-element'+(null!=(f=c.unless.call(h,null!=b?b.edit:b,{name:"unless",hash:{},fn:a.program(10,e,0),inverse:a.noop,data:e}))?f:"")+'">\n          <p class="impact-title">Time</p>\n'+(null!=(f=c.if.call(h,null!=b?b.edit:b,{
name:"if",hash:{},fn:a.program(22,e,0),inverse:a.program(25,e,0),data:e}))?f:"")+'        </div>\n\n        <div class="impact-element'+(null!=(f=c.unless.call(h,null!=b?b.edit:b,{name:"unless",hash:{},fn:a.program(10,e,0),inverse:a.noop,data:e}))?f:"")+'">\n          <p class="impact-title">Sustainability</p>\n'+(null!=(f=c.if.call(h,null!=b?b.edit:b,{name:"if",hash:{},fn:a.program(27,e,0),inverse:a.program(30,e,0),data:e}))?f:"")+"        </div>\n        \n      </div>\n\n    </div>\n  </div>\n</li>\n\n"},useData:!0}),this.BestForMe.Templates["agility/solution-grid-item"]=Handlebars.template({1:function(a,b,c,d,e){return" disabled"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<li class="solution-hex" id="'+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,typeof g===j?g.call(h,{name:"id",hash:{},data:e}):g))+'">\n  <div class="hex-in">\n    <a class="hex-link '+k((g=null!=(g=c.hexType||(null!=b?b.hexType:b))?g:i,typeof g===j?g.call(h,{name:"hexType",hash:{},data:e}):g))+"\">\n      <span class='hex-bg "+k((g=null!=(g=c.type||(null!=b?b.type:b))?g:i,typeof g===j?g.call(h,{name:"type",hash:{},data:e}):g))+(null!=(f=c.if.call(h,null!=b?b.disabled:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"'></span>\n      <h1>"+k((g=null!=(g=c.title||(null!=b?b.title:b))?g:i,typeof g===j?g.call(h,{name:"title",hash:{},data:e}):g))+"</h1>\n    </a>\n  </div>\n</li>"},useData:!0}),this.BestForMe.Templates["agility/solution-grid-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<ul id="solution-hex-grid">\n</ul>\n\n'},useData:!0}),this.BestForMe.Templates["agility/solution-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section id="solution-grid">\n</section>\n<section id="solution-filter">\n</section>'},useData:!0}),this.BestForMe.Templates["agility/tactic-view"]=Handlebars.template({1:function(a,b,c,d,e){var f;return'  \t<section id="error">\n        <p>'+a.escapeExpression((f=null!=(f=c.errorMessage||(null!=b?b.errorMessage:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"errorMessage",hash:{},data:e}):f))+"</p>\n    </section>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<div class="final-tactic">\n'+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.errorMessage:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'  <section id="canvas-grid">\n  </section>\n  <section id="canvas-filter">\n  </section>\n</div>'},useData:!0}),this.BestForMe.Templates["agility/tactical-canvas-collection-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section id="tactical-canvas-collection" class="tactical-canvas-collection">\n</section>\n\n<div class="add-canvas">\n  <button id="add-canvas" class="button"></button>\n</div>'},useData:!0}),this.BestForMe.Templates["agility/tactical-canvas-grid-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=null!=b?b:{},h=c.helperMissing,i="function",j=a.escapeExpression;return'  <section class="tactical-canvas-grid">\n\n    <div class="canvas-connection-tray">\n      <p>Drag and drop AND & OR to annotate the connections between solutions:</p>\n      <ul class="canvas-and-or-grid">\n\n        <li class="boolean-hex and">\n          <div class="hex-in">\n            <a class="hex-link" href="#">\n              <span class=\'hex-bg '+j((f=null!=(f=c.type||(null!=b?b.type:b))?f:h,typeof f===i?f.call(g,{name:"type",hash:{},data:e}):f))+'\'></span>\n              <h1>AND</h1>\n            </a>\n          </div>\n        </li>\n        <li class="boolean-hex or">\n          <div class="hex-in">\n            <a class="hex-link" href="#">\n              <span class=\'hex-bg '+j((f=null!=(f=c.type||(null!=b?b.type:b))?f:h,typeof f===i?f.call(g,{name:"type",hash:{},data:e}):f))+'\'></span>\n              <h1>OR</h1>\n            </a>\n          </div>\n        </li>\n        <li class="boolean-hex clear">\n          <div class="hex-in">\n            <a class="hex-link" href="#">\n              <span class=\'hex-bg '+j((f=null!=(f=c.type||(null!=b?b.type:b))?f:h,typeof f===i?f.call(g,{name:"type",hash:{},data:e}):f))+'\'></span>\n              <h1>CLEAR</h1>\n            </a>\n          </div>\n        </li>\n\n      </ul>\n    </div>\n\n    <div class="canvas-grid">\n      <ul class="canvas-grid-list">\n      </ul>\n    </div>\n\n  </section>\n'},useData:!0}),this.BestForMe.Templates["agility/tactical-canvas-info-view"]=Handlebars.template({1:function(a,b,c,d,e){var f;return'    <textarea class="canvas-title-input" name="canvas-title-input" rows="1">'+a.escapeExpression((f=null!=(f=c.canvasTitle||(null!=b?b.canvasTitle:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"canvasTitle",hash:{},data:e}):f))+'</textarea>\n    <div class="canvas-buttons canvas-buttons-edit-mode">\n      <button class="canvas-title-save">Save</button>\n      <button class="canvas-delete">Delete</button>\n    </div>\n'},3:function(a,b,c,d,e){var f;return'    <h1 class="canvas-title">'+a.escapeExpression((f=null!=(f=c.canvasTitle||(null!=b?b.canvasTitle:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"canvasTitle",hash:{},data:e}):f))+'</h1>\n    <div class="canvas-buttons">\n      <button class="canvas-title-edit">Edit</button>\n      <button class="canvas-delete">Delete</button>\n    </div>\n'},5:function(a,b,c,d,e){return"checked"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<section class="tactical-canvas-info">\n\n  <div class="tactical-canvas-title">\n'+(null!=(f=c.if.call(h,null!=b?b.edit:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.program(3,e,0),data:e}))?f:"")+'  </div>\n\n  <div class="tactical-canvas-meta">\n    <p class="tactical-canvas-score">Agility Score: '+k((g=null!=(g=c.agilityScore||(null!=b?b.agilityScore:b))?g:i,typeof g===j?g.call(h,{name:"agilityScore",hash:{},data:e}):g))+'</p>\n    <p class="tactical-canvas-score">Complexity Score: '+k((g=null!=(g=c.complexityScore||(null!=b?b.complexityScore:b))?g:i,typeof g===j?g.call(h,{name:"complexityScore",hash:{},data:e}):g))+'</p>\n    <p class="pref-text">Preferred Canvas? </p><input id=\'pref-canvas-'+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,typeof g===j?g.call(h,{name:"id",hash:{},data:e}):g))+'\' type="checkbox" class="preferred-checkbox star" '+(null!=(f=c.if.call(h,null!=b?b.isFavourite:b,{name:"if",hash:{},fn:a.program(5,e,0),inverse:a.noop,data:e}))?f:"")+'><label for="pref-canvas-'+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,typeof g===j?g.call(h,{name:"id",hash:{},data:e}):g))+'"></label>\n  </div>\n\n</section>'},useData:!0}),this.BestForMe.Templates["agility/tactical-canvas-item-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section class="tactical-canvas">\n\n  <div class="canvas-info">\n  </div>\n\n  <div class="canvas-grid-ui">\n  </div>\n\n</section>'},useData:!0}),this.BestForMe.Templates["agility/technical-solution-filter-view"]=Handlebars.template({1:function(a,b,c,d,e){var f,g=null!=b?b:{},h=c.helperMissing,i="function",j=a.escapeExpression;return'\n    <div class="section agility-score">\n      <h3>Agility Score:</h3>\n      <h3>'+j((f=null!=(f=c.agility||(null!=b?b.agility:b))?f:h,typeof f===i?f.call(g,{name:"agility",hash:{},data:e}):f))+'</h3>\n    </div>\n    <div class="section complexity-score">\n      <h3>Complexity Score:</h3>\n      <h3>'+j((f=null!=(f=c.complexity||(null!=b?b.complexity:b))?f:h,typeof f===i?f.call(g,{name:"complexity",hash:{},data:e}):f))+"</h3>\n    </div>\n\n"},3:function(a,b,c,d,e){var f,g=null!=b?b:{};return"\n"+(null!=(f=c.if.call(g,null!=b?b.showAgilityScore:b,{name:"if",hash:{},fn:a.program(4,e,0),inverse:a.noop,data:e}))?f:"")+(null!=(f=c.if.call(g,null!=b?b.showComplexityScore:b,{name:"if",hash:{},fn:a.program(6,e,0),inverse:a.noop,data:e}))?f:"")+"\n"},4:function(a,b,c,d,e){var f;return'      <div class="section agility-score">\n        <h3>Agility Score:</h3>\n        <h3>'+a.escapeExpression((f=null!=(f=c.agilityScore||(null!=b?b.agilityScore:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"agilityScore",hash:{},data:e}):f))+"</h3>\n      </div>\n"},6:function(a,b,c,d,e){var f;return'      <div class="section complexity-score">\n        <h3>Complexity Score:</h3>\n        <h3>'+a.escapeExpression((f=null!=(f=c.complexityScore||(null!=b?b.complexityScore:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"complexityScore",hash:{},data:e}):f))+"</h3>\n      </div>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression,l=a.lambda;return'<div class="technical-solution-filter">\n\n'+(null!=(f=c.if.call(h,null!=b?b.overrideScore:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.program(3,e,0),data:e}))?f:"")+'\n  <div class="section operational-need-summary">\n    <h3 class="section-title">Objective: '+k((g=null!=(g=c.name||(null!=b?b.name:b))?g:i,typeof g===j?g.call(h,{name:"name",hash:{},data:e}):g))+"</h3>\n    <p>Tactical Family: "+k(l(null!=(f=null!=(f=null!=b?b.tacticalFamily:b)?f.attributes:f)?f.name:f,b))+"</p>\n    <p>Solution Requirements: "+k((g=null!=(g=c.solutionRequirements||(null!=b?b.solutionRequirements:b))?g:i,typeof g===j?g.call(h,{name:"solutionRequirements",hash:{},data:e}):g))+'</p>\n  </div>\n\n  <div class="section filter">\n    <h3 class="section-title">Global Scoring Paths</h3>\n    <p>Cost</p>\n    <input class="filter-input filter-cost" type="range" step="1" min="1" max="5" list="tickmarks-cost" name="cost" value="'+k(l(null!=(f=null!=(f=null!=b?b.filter:b)?f.attributes:f)?f.cost:f,b))+'">\n      <datalist id="tickmarks-cost">\n        <option value="1" label="1">\n        <option value="2">\n        <option value="3">\n        <option value="4">\n        <option value="5" label="5">\n      </datalist>\n    <p>Quality</p>\n    <input class="filter-input filter-quality" type="range" step="1" min="1" max="5" list="tickmarks-quality" name="quality" value="'+k(l(null!=(f=null!=(f=null!=b?b.filter:b)?f.attributes:f)?f.quality:f,b))+'">\n      <datalist id="tickmarks-quality">\n        <option value="1" label="1">\n        <option value="2">\n        <option value="3">\n        <option value="4">\n        <option value="5" label="5">\n      </datalist>\n    <p>Development Time</p>\n    <input class="filter-input filter-time" type="range" step="1" min="1" max="5" list="tickmarks-time" name="time" value="'+k(l(null!=(f=null!=(f=null!=b?b.filter:b)?f.attributes:f)?f.time:f,b))+'">\n      <datalist id="tickmarks-time">\n        <option value="1" label="1">\n        <option value="2">\n        <option value="3">\n        <option value="4">\n        <option value="5" label="5">\n      </datalist>\n    <p>Sustainability</p>\n    <input class="filter-input filter-sustainability" type="range" step="1" min="1" max="5" list="tickmarks-sustainability" name="sustainability" value="'+k(l(null!=(f=null!=(f=null!=b?b.filter:b)?f.attributes:f)?f.sustainability:f,b))+'">\n      <datalist id="tickmarks-sustainability">\n        <option value="1" label="1">\n        <option value="2">\n        <option value="3">\n        <option value="4">\n        <option value="5" label="5">\n      </datalist>\n  </div>\n\n</div>\n'},useData:!0}),this.BestForMe.Templates["app-layout"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<header id="header"></header>\n<main id="main"></main>\n<tutorial id="tutorial"></tutorial>\n<footer id="footer"></footer>'},useData:!0}),this.BestForMe.Templates["error-screen"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<section id="error">\n  <div class="error-notice">\n    <p class="error-message">'+a.escapeExpression((f=null!=(f=c.message||(null!=b?b.message:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"message",hash:{},data:e}):f))+"</p>\n  </div>\n</section>\n"},useData:!0}),this.BestForMe.Templates["export/export-final-tactic"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<div class="export_canvas">\n  <section id="canvas-grid"></section>\n</div>\n'},useData:!0}),this.BestForMe.Templates["export/operational-need-export"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<div class="export_operational-need">\n  <section id="operational-need-list__tactical">\n  </section>\n</div>\n'},useData:!0}),this.BestForMe.Templates["export/parameter-export"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<div class="export_parameters">\n  <section id="parameter-list__tactical">\n  </section>\n</div>\n'},useData:!0}),this.BestForMe.Templates["footer/footer"]=Handlebars.template({1:function(a,b,c,d,e){return" hidden"},3:function(a,b,c,d,e){var f;return"/"+a.escapeExpression((f=null!=(f=c.operationalNeedId||(null!=b?b.operationalNeedId:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"operationalNeedId",hash:{},data:e}):f))},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<footer class="footer">\n  <div class="footer-container">\n    <div class="footer-content">\n      <div class="tutorial-button">\n        <button id="show-tutorial" class="button"></button>\n      </div>\n      <div class="save-button'+(null!=(f=c.unless.call(h,null!=b?b.showSave:b,{name:"unless",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'">\n        <button id="save-content" class="button"></button>\n      </div>\n      <div class="export-button'+(null!=(f=c.unless.call(h,null!=b?b.showExport:b,{name:"unless",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'">\n        <a href="'+k((g=null!=(g=c.origin||(null!=b?b.origin:b))?g:i,typeof g===j?g.call(h,{name:"origin",hash:{},data:e}):g))+k((g=null!=(g=c.exportLink||(null!=b?b.exportLink:b))?g:i,typeof g===j?g.call(h,{name:"exportLink",hash:{},data:e}):g))+k((g=null!=(g=c.projectId||(null!=b?b.projectId:b))?g:i,typeof g===j?g.call(h,{name:"projectId",hash:{},data:e}):g))+(null!=(f=c.if.call(h,null!=b?b.operationalNeedId:b,{name:"if",hash:{},fn:a.program(3,e,0),inverse:a.noop,data:e}))?f:"")+'" target="_blank"><button id="export-content" class="button"></button></a>\n      </div>\n    </div>\n  </div>\n</footer>\n'},useData:!0}),this.BestForMe.Templates.header=Handlebars.template({1:function(a,b,c,d,e){var f;return": "+a.escapeExpression((f=null!=(f=c.projectTitle||(null!=b?b.projectTitle:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"projectTitle",hash:{},data:e}):f))},3:function(a,b,c,d,e){var f;return" - "+a.escapeExpression((f=null!=(f=c.operationalNeedTitle||(null!=b?b.operationalNeedTitle:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"operationalNeedTitle",hash:{},data:e}):f))},5:function(a,b,c,d,e){return"hidden"},7:function(a,b,c,d,e,f,g){var h,i=null!=b?b:{},j=a.lambda,k=a.escapeExpression;return'  <li class="main-nav-item btn">\n    <a class="main-nav-link '+(null!=(h=c.if.call(i,null!=(h=null!=b?b.attributes:b)?h.active:h,{name:"if",hash:{},fn:a.program(8,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'" href="'+k(j(null!=(h=null!=b?b.attributes:b)?h.link:h,b))+"/"+k(j(null!=g[1]?g[1].projectId:g[1],b))+(null!=(h=c.if.call(i,null!=(h=null!=b?b.attributes:b)?h.hasOperationalNeedParam:h,{name:"if",hash:{},fn:a.program(10,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'" title="'+k(j(null!=(h=null!=b?b.attributes:b)?h.title:h,b))+'">\n      <span class="main-nav-link-title">'+k(j(null!=(h=null!=b?b.attributes:b)?h.title:h,b))+"</span>\n    </a>\n  </li>\n"},8:function(a,b,c,d,e){return"is-active"},10:function(a,b,c,d,e,f,g){return"/"+a.escapeExpression(a.lambda(null!=g[1]?g[1].operationalNeedId:g[1],b))},12:function(a,b,c,d,e,f,g){var h,i=null!=b?b:{},j=a.lambda,k=a.escapeExpression;return'    <li class="main-nav-item btn">\n      <a class="main-nav-link '+(null!=(h=c.if.call(i,null!=(h=null!=b?b.attributes:b)?h.active:h,{name:"if",hash:{},fn:a.program(8,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'" href="'+k(j(null!=(h=null!=b?b.attributes:b)?h.link:h,b))+"/"+k(j(null!=g[1]?g[1].projectId:g[1],b))+(null!=(h=c.if.call(i,null!=(h=null!=b?b.attributes:b)?h.hasOperationalNeedParam:h,{name:"if",hash:{},fn:a.program(10,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'" title="'+k(j(null!=(h=null!=b?b.attributes:b)?h.title:h,b))+'">\n        <span class="main-nav-link-title">'+k(j(null!=(h=null!=b?b.attributes:b)?h.title:h,b))+"</span>\n      </a>\n    </li>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e,f,g){var h,i,j=null!=b?b:{};return'<div id="header-inner" class="header-inner">\n\n  <div class="brand">\n    <div class="brand-logo"></div>\n    <a href="'+a.escapeExpression((i=null!=(i=c.home||(null!=b?b.home:b))?i:c.helperMissing,"function"==typeof i?i.call(j,{name:"home",hash:{},data:e}):i))+'"><h1 class="brand-title">MSF Pathways'+(null!=(h=c.if.call(j,null!=b?b.projectTitle:b,{name:"if",hash:{},fn:a.program(1,e,0,f,g),inverse:a.noop,data:e}))?h:"")+(null!=(h=c.if.call(j,null!=b?b.operationalNeedTitle:b,{name:"if",hash:{},fn:a.program(3,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'</h1></a>\n  </div>\n\n</div>\n\n<ul id="header-nav" class="'+(null!=(h=c.unless.call(j,null!=b?b.showNav:b,{name:"unless",hash:{},fn:a.program(5,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'">\n'+(null!=(h=c.each.call(j,null!=(h=null!=b?b.nav:b)?h.models:h,{name:"each",hash:{},fn:a.program(7,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'</ul>\n\n<ul id="agility-nav" class="'+(null!=(h=c.unless.call(j,null!=b?b.showAgilityNav:b,{name:"unless",hash:{},fn:a.program(5,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'">\n'+(null!=(h=c.each.call(j,null!=(h=null!=b?b.agility:b)?h.models:h,{name:"each",hash:{},fn:a.program(12,e,0,f,g),inverse:a.noop,data:e}))?h:"")+"</ul>\n\n"},useData:!0,useDepths:!0}),this.BestForMe.Templates["home-screen"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section id="home">\n\n  <ul id="project-grid" class="project-grid">\n    <li class="project-hex">\n      <div class="hex-in">\n        <div class="hex-link">\n          <span class=\'hex-bg\'></span>\n          <h1>New Project</h1>\n          <button id="new-project-button" class="project-open new-button">+</button>\n        </div>\n      </div>\n    </li>\n    <li id="create-project" class="project-hex">\n      <div class="hex-in">\n        <a class="hex-link" href="#">\n          <span class=\'hex-bg\'></span>\n          <input class="project-name-input"> </input>\n          <button id="create-project-button" class="project-open new-button">Create</button>\n        </a>\n      </div>\n    </li>\n    <div id="project-list">\n\n    </div>\n  </ul>\n\n</section>\n'},useData:!0}),this.BestForMe.Templates["loading-screen"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section id="loading">\n  <div class="loader"></div>\n</section>\n'},useData:!0}),this.BestForMe.Templates["login-screen"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<div class="full">\n  <div class="login-divide"><div id="login-brand"></div></div>\n<main id="login-screen">\n\n  <form class="login-form">\n    <label for="username">\n    </label>\n    <input name="username" placeholder="Username" class="login-username" type="text">\n    </input>\n    <label for="password">\n    </label>\n    <input name="password" placeholder="Password" class="login-password" type="password">\n    </input>\n    <div class="login-forgotten-password">\n      <input type="checkbox" class="login-save-checkbox" name="login-save" value="login-save"></input>\n      <p class="login-save-prompt">Stay Logged In?</p>\n      <span class="login-reset-password">Forgotten Password?</span>\n    </div>\n    <div class="login-button">\n      <button tname="submit" class="login-submit" type="button">Log in</button>\n    </div>\n  </form>\n</main>\n  <footer class="login-footer">\n    <div class="login-footer-items">\n    <span class="login-footer-icon"></span>\n    <p class="login-footer-text">Powered by BestForMe</p>\n    </div>\n  </footer>\n</div>\n'},useData:!0}),this.BestForMe.Templates["parameters/parameter-grid-item"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=null!=b?b:{},h=c.helperMissing,i="function",j=a.escapeExpression;return'<li class="parameter-hex" id="'+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,typeof f===i?f.call(g,{name:"id",hash:{},data:e}):f))+'">\n  <div class="hex-in">\n    <a class="hex-link '+j((f=null!=(f=c.type||(null!=b?b.type:b))?f:h,typeof f===i?f.call(g,{name:"type",hash:{},data:e}):f))+"\">\n      <span class='hex-bg "+j((f=null!=(f=c.type||(null!=b?b.type:b))?f:h,typeof f===i?f.call(g,{name:"type",hash:{},data:e}):f))+"'></span>\n      <h1>"+j((f=null!=(f=c.title||(null!=b?b.title:b))?f:h,typeof f===i?f.call(g,{name:"title",hash:{},data:e}):f))+"</h1>\n    </a>\n  </div>\n</li>"},useData:!0}),this.BestForMe.Templates["parameters/parameter-grid"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section class="parameter-grid">\n  <h1 class="page-title">Parameter Guide</h1>\n  <ul id="parameter-hex-grid" data-style="display: flex;">\n\n  </ul>\n</section>'},useData:!0}),this.BestForMe.Templates["parameters/parameter-item"]=Handlebars.template({1:function(a,b,c,d,e){var f,g,h=null!=b?b:{};return'    <div class="parameter-description">\n      <p>'+a.escapeExpression((g=null!=(g=c.description||(null!=b?b.description:b))?g:c.helperMissing,"function"==typeof g?g.call(h,{name:"description",hash:{},data:e}):g))+"</p>\n    </div>\n"+(null!=(f=c.if.call(h,null!=b?b.isCustom:b,{name:"if",hash:{},fn:a.program(2,e,0),inverse:a.noop,data:e}))?f:"")},2:function(a,b,c,d,e){return'      <div class="parameter-delete">\n        <button class="parameter-delete-button" name="parameter-delete"></button>\n      </div>\n'},4:function(a,b,c,d,e){var f;return"\n"+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.textInput:b,{name:"if",hash:{},fn:a.program(5,e,0),inverse:a.noop,data:e}))?f:"")+"\n"},5:function(a,b,c,d,e){var f;return'      <div class="parameter-input">\n        <textarea class="user-input" name="parameter-input" rows="5">'+a.escapeExpression((f=null!=(f=c.userText||(null!=b?b.userText:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"userText",hash:{},data:e}):f))+"</textarea>\n      </div>\n"},7:function(a,b,c,d,e){var f;return"\n"+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.textInput:b,{name:"if",hash:{},fn:a.program(8,e,0),inverse:a.program(10,e,0),data:e}))?f:"")+"\n"},8:function(a,b,c,d,e){var f;return'    \n      <div class="parameter-user-text parameter-description">\n        <p>'+a.escapeExpression((f=null!=(f=c.userText||(null!=b?b.userText:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"userText",hash:{},data:e}):f))+"</p>\n      </div>\n\n"},10:function(a,b,c,d,e){var f,g=null!=b?b:{};return'\n      <div class="parameter-option-display parameter-description">\n        <ul class="parameter-option-list">\n\n'+(null!=(f=c.each.call(g,null!=(f=null!=b?b.options:b)?f.models:f,{name:"each",hash:{},fn:a.program(11,e,0),inverse:a.noop,data:e}))?f:"")+"\n"+(null!=(f=c.if.call(g,null!=b?b.userText:b,{name:"if",hash:{},fn:a.program(14,e,0),inverse:a.noop,data:e}))?f:"")+"\n        </ul>\n      </div>\n\n"},11:function(a,b,c,d,e){var f;return null!=(f=c.if.call(null!=b?b:{},null!=(f=null!=b?b.attributes:b)?f.selected:f,{name:"if",hash:{},fn:a.program(12,e,0),inverse:a.noop,data:e}))?f:""},12:function(a,b,c,d,e){var f;return'              <li class="parameter-option">\n                <p>'+a.escapeExpression(a.lambda(null!=(f=null!=b?b.attributes:b)?f.name:f,b))+"</p>\n              </li>\n"},14:function(a,b,c,d,e){var f;return'            <li class="parameter-option">\n              <p>'+a.escapeExpression((f=null!=(f=c.userText||(null!=b?b.userText:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"userText",hash:{},data:e}):f))+"</p>\n            </li>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<div class="parameter-item '+k((g=null!=(g=c.type||(null!=b?b.type:b))?g:i,typeof g===j?g.call(h,{name:"type",hash:{},data:e}):g))+'" id="'+k((g=null!=(g=c.type||(null!=b?b.type:b))?g:i,typeof g===j?g.call(h,{name:"type",hash:{},data:e}):g))+k((g=null!=(g=c.paramId||(null!=b?b.paramId:b))?g:i,typeof g===j?g.call(h,{name:"paramId",hash:{},data:e}):g))+'" data-id="'+k((g=null!=(g=c.paramId||(null!=b?b.paramId:b))?g:i,typeof g===j?g.call(h,{name:"paramId",hash:{},data:e}):g))+'">\n  <div class="parameter-item-hex">\n    <div class="hex-container">\n      <div class="hex-item" id="1">\n        <div class="hex-in">\n          <a class="hex-link">\n            <span class=\'hex-bg '+k((g=null!=(g=c.type||(null!=b?b.type:b))?g:i,typeof g===j?g.call(h,{name:"type",hash:{},data:e}):g))+"'></span>\n            <h1>"+k((g=null!=(g=c.name||(null!=b?b.name:b))?g:i,typeof g===j?g.call(h,{name:"name",hash:{},data:e}):g))+"</h1>\n          </a>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  \n"+(null!=(f=c.if.call(h,null!=b?b.edit:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'\n  <div class="parameter-options-dropdown"></div>\n  <div class="parameter-options-checkbox"></div>\n\n'+(null!=(f=c.if.call(h,null!=b?b.edit:b,{name:"if",hash:{},fn:a.program(4,e,0),inverse:a.program(7,e,0),data:e}))?f:"")+"\n</div>\n"},useData:!0}),this.BestForMe.Templates["parameters/parameter-list"]=Handlebars.template({1:function(a,b,c,d,e){var f,g=null!=b?b:{},h=c.helperMissing,i="function",j=a.escapeExpression;return'<section id="new-parameter" class="parameter-item-list">\n  <div class="parameter-item '+j((f=null!=(f=c.type||(null!=b?b.type:b))?f:h,typeof f===i?f.call(g,{name:"type",hash:{},data:e}):f))+j((f=null!=(f=c.paramId||(null!=b?b.paramId:b))?f:h,typeof f===i?f.call(g,{name:"paramId",hash:{},data:e}):f))+'" data-id="'+j((f=null!=(f=c.paramId||(null!=b?b.paramId:b))?f:h,typeof f===i?f.call(g,{name:"paramId",hash:{},data:e}):f))+'">\n    <div class="parameter-item-hex">\n      <div class="hex-container">\n        <div class="hex-item" id="1">\n          <div class="hex-in">\n            <a class="hex-link">\n              <span class=\'hex-bg '+j((f=null!=(f=c.type||(null!=b?b.type:b))?f:h,typeof f===i?f.call(g,{name:"type",hash:{},data:e}):f))+'\'></span>\n              <h1>New Parameter</h1>\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class="parameter-name">\n      <p>Please enter the name of the new parameter:</p>\n    </div>\n\n    <div class="parameter-name-input-wrapper">\n      <textarea class="user-input parameter-name-input" name="parameter-name-input" rows="2"></textarea>\n    </div>\n\n    <div class="parameter-type">\n      <p>Please select the type of the new parameter:</p>\n    </div>\n\n    <div class="parameter-type-dropdown">\n      <select class="parameter-type-select">\n        <option class="parameter-type-option" value="medical">Medical</option>\n        <option class="parameter-type-option" value="political">Political</option>\n        <option class="parameter-type-option" value="contextual">Contextual</option>\n      </select>\n    </div>\n\n    <div class="parameter-description">\n      <p>Please enter the details for the new parameter:</p>\n    </div>\n\n    <div class="parameter-description-input-wrapper">\n      <textarea class="user-input parameter-description-input" name="parameter-description-input" rows="5"></textarea>\n    </div>\n\n    <div class="add-parameter-button">\n      <button id="add-parameter-button" class="button"> </button>\n    </div>\n\n  </div>\n</section>\n'},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<section id="parameter-item-list" class="parameter-item-list">\n\n</section>\n\n'+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.edit:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")},useData:!0}),this.BestForMe.Templates["parameters/parameter-option-checkbox"]=Handlebars.template({1:function(a,b,c,d,e){var f,g=a.lambda,h=a.escapeExpression;return'        \t<li class="parameter-option">\n          \t<label><input class="parameter-option-checkbox" type="checkbox" data-option-id="'+h(g(null!=b?b.optionId:b,b))+'" '+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.selected:b,{name:"if",hash:{},fn:a.program(2,e,0),inverse:a.noop,data:e}))?f:"")+">"+h(g(null!=b?b.name:b,b))+"</label>\n        \t</li>\n"},2:function(a,b,c,d,e){return"checked"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{};return'<div class="parameter-option-checkboxes-wrapper">\t\n\t<ul class="parameter-option-checkboxes">\n'+(null!=(f=c.each.call(h,null!=b?b.items:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'\t</ul>\n\t<div class="parameter-option-other-specify">\n\t\t<textarea class="user-input parameter-option-other-input" name="parameter-option-other-input" rows="2">'+a.escapeExpression((g=null!=(g=c.otherText||(null!=b?b.otherText:b))?g:c.helperMissing,"function"==typeof g?g.call(h,{name:"otherText",hash:{},data:e}):g))+"</textarea>\n\t</div>\n</div>\n"},useData:!0}),this.BestForMe.Templates["parameters/parameter-option-select"]=Handlebars.template({1:function(a,b,c,d,e){var f,g=a.lambda,h=a.escapeExpression;return'        \t<option class="parameter-option" value="'+h(g(null!=b?b.optionId:b,b))+'" '+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.selected:b,{name:"if",hash:{},fn:a.program(2,e,0),inverse:a.noop,data:e}))?f:"")+">"+h(g(null!=b?b.name:b,b))+"</option>\n"},2:function(a,b,c,d,e){return"selected"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{};return'<div class="parameter-option-select-wrapper">\n\t<select class="parameter-option-select">\n'+(null!=(f=c.each.call(h,null!=b?b.items:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'\t</select>\n    <div class="parameter-option-other-specify">\n\t\t<textarea class="user-input parameter-option-other-input" name="parameter-option-other-input" rows="2">'+a.escapeExpression((g=null!=(g=c.otherText||(null!=b?b.otherText:b))?g:c.helperMissing,"function"==typeof g?g.call(h,{name:"otherText",hash:{},data:e}):g))+"</textarea>\n\t</div>\n</div>"},useData:!0}),this.BestForMe.Templates["parameters/parameter-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section id="parameter-grid">\n\n</section>\n<section id="parameter-list">\n\n</section>'},useData:!0}),this.BestForMe.Templates["project/project-item"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<li class="project-link">\n  <div class="hex-in">\n    <a class="hex-link">\n      <span class=\'hex-bg\'></span>\n      <h1>'+a.escapeExpression((f=null!=(f=c.name||(null!=b?b.name:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:{},{name:"name",hash:{},data:e}):f))+'</h1>\n      <button class="project-open new-button">Open</button>\n    </a>\n  </div>\n</li>'},useData:!0}),this.BestForMe.Templates["project/project-list"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section id="projects">\n\n  <ul id="project-grid" class="project-grid">\n\n    <li id="new-project" class="project-hex">\n      <div class="hex-in">\n        <div class="hex-link">\n          <span class="hex-bg"></span>\n          <h1>New Project</h1>\n          <button id="new-project-button" class="project-new new-button">+</button>\n        </div>\n      </div>\n    </li>\n\n    <li id="create-project" class="project-hex">\n      <div class="hex-in">\n        <a class="hex-link" href="#">\n          <span class="hex-bg"></span>\n          <input type="text" class="project-name-input" placeholder="Project name">\n          <button id="create-project-button" class="project-create new-button">Create</button>\n        </a>\n      </div>\n    </li>\n\n  </ul>\n\n  <ul id="project-list">\n\n  </ul>\n\n</section>\n';
},useData:!0}),this.BestForMe.Templates["tactical/operational-need-item"]=Handlebars.template({1:function(a,b,c,d,e){return'        <button class="operational-need-delete" name="operational-need-delete"></button>\n'},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<section class="operational-need-item">\n\n<button class="accordion">Operational Need: '+k((g=null!=(g=c.name||(null!=b?b.name:b))?g:i,typeof g===j?g.call(h,{name:"name",hash:{},data:e}):g))+'</button>\n\n<div class="panel">\n  <div class="operational-need-item">\n\n    <div class="section need-title">\n      <h3>Operational Need</h3>\n      <p class="section-label">Define the need that the tactic must address</p>\n      <textarea class="title-input" name="Operational Need Title" rows="3" >'+k((g=null!=(g=c.name||(null!=b?b.name:b))?g:i,typeof g===j?g.call(h,{name:"name",hash:{},data:e}):g))+'</textarea>\n    </div>\n\n    <div class="section tactical-family">\n      <h3 class="section-title">Tactical Family</h3>\n      <p class="section-label">Select the corresponding tactical family</p>\n      <div class="tactical-family-dropdown">\n      </div>\n    </div>\n\n    <div class="section solution-requirements">\n      <h3 class="section-title">Solution Requirements</h3>\n      <p class="section-label">Take into account the key parameters. Write the conditions that the solutions must fulfil, starting from the most important. Use keywords</p>\n      <textarea class="requirements-input" name="Solution Requirements" rows="10" >'+k((g=null!=(g=c.solutionRequirements||(null!=b?b.solutionRequirements:b))?g:i,typeof g===j?g.call(h,{name:"solutionRequirements",hash:{},data:e}):g))+'</textarea>\n    </div>\n\n    <div class="section technical-families">\n      <h3 class="section-title">Technical Families Implicated</h3>\n      <p class="section-label">Select which technical families are implicated. Select the main one(s) first</p>\n      <div class="technical-families-grid">\n      </div>\n    </div>\n\n    <div class="section departments">\n      <h3 class="section-title">Other Departments Implicated</h3>\n      <p class="section-label">Identify the support requested for staffing and Supply</p>\n      <textarea class="departments-input" name="Departments Implicated" rows="10">'+k((g=null!=(g=c.otherDepartments||(null!=b?b.otherDepartments:b))?g:i,typeof g===j?g.call(h,{name:"otherDepartments",hash:{},data:e}):g))+'</textarea>\n    </div>\n\n    <div class="section stakeholders">\n      <h3 class="section-title">Role of External Stakeholders</h3>\n      <p class="section-label">Possible collaborations and coordination that might be needed for your project</p>\n      <textarea class="stakeholders-input" name="External Stakeholders" rows="10">'+k((g=null!=(g=c.externalStakeholders||(null!=b?b.externalStakeholders:b))?g:i,typeof g===j?g.call(h,{name:"externalStakeholders",hash:{},data:e}):g))+'</textarea>\n    </div>\n\n    <section class="section operational-need-buttons">\n'+(null!=(f=c.if.call(h,null!=b?b.deleteAllowed:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+'      <button class="operational-need-save" name="operational-need-save"></button>\n    </section>\n\n  </div>\n</div>\n\n</section>\n'},useData:!0}),this.BestForMe.Templates["tactical/operational-need-list"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section id="operational-need-list" class="operational-need-list">\n\n</section>\n\n<div class="add-operational-need">\n  <button id="add-operational-need" class="button"></button>\n</div>'},useData:!0}),this.BestForMe.Templates["tactical/tactical-family-select"]=Handlebars.template({1:function(a,b,c,d,e){var f,g=a.lambda,h=a.escapeExpression;return'        <option class="tactical-option" value="'+h(g(null!=b?b.familyId:b,b))+'" '+(null!=(f=c.if.call(null!=b?b:{},null!=b?b.selected:b,{name:"if",hash:{},fn:a.program(2,e,0),inverse:a.noop,data:e}))?f:"")+">"+h(g(null!=b?b.name:b,b))+"</option>\n"},2:function(a,b,c,d,e){return"selected"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<select class="tactical-family-select">\n'+(null!=(f=c.each.call(null!=b?b:{},null!=b?b.items:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"</select>\n"},useData:!0}),this.BestForMe.Templates["tactical/tactical-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section id="parameter-list__tactical">\n</section>\n<section id="operational-need-list__tactical">\n</section>'},useData:!0}),this.BestForMe.Templates["tactical/technical-family-item"]=Handlebars.template({1:function(a,b,c,d,e){return" active"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:{},i=c.helperMissing,j="function",k=a.escapeExpression;return'<li class="technical-hex" id="'+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,typeof g===j?g.call(h,{name:"id",hash:{},data:e}):g))+'">\n  <div class="hex-in">\n    <a class="hex-link" href="#">\n      <span class=\'hex-bg '+k((g=null!=(g=c.type||(null!=b?b.type:b))?g:i,typeof g===j?g.call(h,{name:"type",hash:{},data:e}):g))+(null!=(f=c.if.call(h,null!=b?b.selected:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"'></span>\n      <h1>"+k((g=null!=(g=c.name||(null!=b?b.name:b))?g:i,typeof g===j?g.call(h,{name:"name",hash:{},data:e}):g))+"</h1>\n    </a>\n  </div>\n</li>"},useData:!0}),this.BestForMe.Templates["tactical/technical-family-list"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<ul id="technical-family-list">\n\n</ul>'},useData:!0}),this.BestForMe.Templates["tutorials/pages/agility-matrix-example"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"<h1>Agility Matrix Example</h1>\n<h2>Jackie in South Sudan, Step 3: Agility Matrix</h2>\n<h2>Option infrastructures:</h2>\n<ul>\n    <li>Elevated prefabricated structure, international. Scoring: Quality/good, Cost/high, Time/high, Sustainability/high</li>\n    <li>Modular prefabricated structure, regional. Scoring: Quality/Low-medium, Cost/medium, Time/low, Sustainability/medium-high</li>\n    <li>Mud bricks buildings with drainage underneath, local. Scoring: Quality/medium, Cost/low, Time/medium-low, Sustainability/low</li>\n</ul>\n<h2>Options HFM:</h2>\n<ul>\n    <li>Master plan N°1, location in the OPD entrance. Scoring: Quality/good, Time/medium, Cost/high Sustainability/medium<br>This option is good for the flow of the patients and the gender separation possibilities.</li>\n    <li>Master plan N°2, location in-between the OPD and the IPD, 2 floor construction. Scoring: Quality/medium, Cost/low, Time/high, Sustainability/medium <br>This option is good for the possibility of future extension and for the flow of the staff.</li>\n</ul>\n<h2>Options energy:</h2>\n<ul>\n    <li>Additional generator, local. Scoring: Quality/medium-good, Cost/medium, Time/medium, Sustainability/medium-high <br>The energy referent said that with the generator, energy needs will be covered.</li>\n    <li>Solar panels, regional. Scoring: Quality/good, Cost/high, Time/high, Sustainability/high <br>The energy referent said that we will need a specialist to implement the solar panels and that we will need a lot of panels, to make sure we have sufficient energy.</li>\n    <li>Hybrid generator/solar panel, international : Quality/good, Cost/medium, Time/high, Sustainability/medium-high <br>The energy referent said we could have direct solar energy during the day and the addition of a smaller generator for the night. As the installation is simple, there is no need to have specific resources to implement it.</li>\n</ul>\n<h2>Options Watsan:</h2>\n<ul>\n    <li>Standard plumbing network + drainage underneath the new construction</li>\n</ul>\n<h2>Options cold chain:</h2>\n<ul>\n    <li>Standard fridge for vaccine, regional stock. Scoring: Quality/good, Cost/medium, Time/low, Sustainability/medium</li>\n    <li>Solar fridge for vaccine, international. Scoring: Quality/good, Cost/medium, Time/high, Sustainability/high</li>\n    <li>Reuse existing fridge, local. Scoring: Quality/good, Cost/low, Time/low, Sustainability/medium</li>\n</ul>"},useData:!0}),this.BestForMe.Templates["tutorials/pages/agility-matrix-tutorial"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"<h1>Agility Matrix Tutorial</h1>\n\n<h2>Technical Solution Library</h2>\n<p>Input up to 3 solutions for each Tactical Family</p>\n<h2>Tactical Canvas</h2>\n<p>Drag and drop the solutions from the library</p>\n<p>Connect the solutions that better answer the operation need, with and/or hexagons</p>\n<h2>Final Tactic</h2>\n<p>Evaluate your final tactic through the scoring paths</p>"},useData:!0}),this.BestForMe.Templates["tutorials/pages/parameter-example"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"<h1>Parameter Guide Example</h1>\n<h2>Jackie in South-Sudan, Step 1 : Parameter Guide</h2>\n<h2>Medical activity:</h2>\n<p>The out-patient clinic should be improved with more consultation rooms for family planning, ante and post-natal care. Vaccination of the women should be done.</p>\n<h2>Targeted beneficiaries:</h2>\n<p>There is a general target on refugees. There is a specific target on the care of women (Sexual Reproductive Health)</p>\n<h2>Total number of beneficiaries:</h2>\n<p>The medical focal point foresees 60 consultations/day for the first month. After it should increase. The medical focal point is requesting 3 new consultations for family planning, ante and post-natal care.</p>\n<h2>Infection control:</h2>\n<p>Apply the standard requirement for hygiene. There is no specific measure to take.</p>\n<h2>Type of facility:</h2>\n<p>Outpatient department, part of a health facility (inpatient department and a small maternity department). Both facilities are sharing the same compound. There is some space left on the compound at the entrance close to the OPD but really not much.</p>\n<h2>Ancillary and supportive services: </h2>\n<p>(After discussion with the medical focal point of my project) the women that will come can use the laboratory of the OPD. A space for dispensary will be necessary for drugs distribution, but it is not clear yet where it should be located. We will need to arrange a waiting area. Additional latrines will have to be built.</p>\n<h2>Investment choice:</h2>\n<p>(After discussion with my fieldco) the extension of the OPD should be ready within 6 months. This is not an emergency! This project has been presented in the AROs and we have a budget of XXX euros.</p>\n<h2>Timing of operation:</h2>\n<p>This is a 5 year project. We are now in the third year of it. This is a project by default, so the duration may extend depending of the situation.</p>\n<h2>Exit strategy:</h2>\n<p>This is an MSF stand-alone project. There is another organization present that is responsible for food distribution and nothing else. The project will close when the refugee situation is solved.</p>\n<h2>Setting (URBAN-RURAL-CAMP):</h2>\n<p>We are located in a camp in the bush. There is a small city 10 min drive away by car called Pipore. This is in South-Sudan. There are a lot of people in the camp but outside of it there is nobody.</p>\n<h2>Security (SAFE-UNSAFE-CONFLICT):</h2>\n<p>There is conflict in the country. The situation is unsafe in the camp. We can only walk around during the daytime apart from when we receive a special notification from the fieldco.</p>\n<h2>Access:</h2>\n<p>The roads are more tracks than road. Hopefully, our activities are set in the camp and so the beneficiaries can come by foot. When we go to the market in Pipore on Sundays, we go by car. But for the rest, everything is transported by plane.</p>\n<h2>Climate, season, geography and soil:</h2>\n<p>The rainy season lasts around 6 months and for the remaining time the climate is dry and hot, around 35°. The land is mostly flat with  the occasional big Baobab tree. The ground is very sandy and dusty, so when the wind blows the grains go everywhere. The Watson told me that the soil is comprised of a mixture of Clay and Laterite. The water table is also very high.</p>\n<h2>Local resources:</h2>\n<p>Everything is coming from Juba at the exception of some basic hygiene items and a bit of food that we can find locally. Small facilities and basic products (hygiene and food) are available in small quantities in the city.</p>\n<p>The refugees are under tents. But in Pibore, the house and the shops are made of mud bricks (which is good for this climate). A machine to create the bricks, is available in the other NGO camp (for food distribution). There are some stock wood, gravel and stone. My team is made of 3 logs, 1 log base (from Juba), 1 log tech (from Pibore) and me.</p>\n<h2>Cultural and societal appropriateness: </h2>\n<p>The staff told me the women are not mixed with men in the hospital. There are 2 waiting areas, but the consultation rooms in the OPD are the same for men and women. There is an average of 4 children per family!</p>\n<h2>Norms and regulations:</h2>\n<p>The authority leases us the OPD compound for free during the time of the activities. They want to have it back free from any construction at the end of the project. No foundations are allowed!</p>"},useData:!0}),this.BestForMe.Templates["tutorials/pages/parameter-tutorial"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"<h1>Parameter Guide Tutorial</h1>\n<h2>About the Paramater Guide</h2>\n<p>The parameter guide is the overview of the most important parameters to take into consideration by MSF LOGs when planning a project. LOG tactics are part of the ecosystem of MSF operations and as such, they should be seen as integrated with the project.</p>"},useData:!0}),this.BestForMe.Templates["tutorials/pages/pathways-example"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"<h1>Pathways Example</h1>\n<p>When relevant, the Example panel presents an example content type, to help you format your data. </p>\n"},useData:!0}),this.BestForMe.Templates["tutorials/pages/pathways-tutorial"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"<h1>Pathways Tutorial</h1>\n<h2>What is Pathways</h2>\n<p>Pathways is a sequence of steps that guide the tactician while developing a specific tactic</p>\n\n<h2>Why Pathways?</h2>\n<ul>\n  <li><strong>Empower</strong> the log tactician to give the best environment of care to our beneficiaries and our medical team activities.</li>\n  <li><strong>Reduce</strong> the gap between the experienced and novice log tacticians and allows qualitative solution within the operational framework.</li>\n</ul>\n\n<h2>When should I use it?</h2>\n<p>Starting a new project or when circumstances in the project have changed</p>"},useData:!0}),this.BestForMe.Templates["tutorials/pages/project-tutorial"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<h1>Project Tutorial</h1>\n<h2>What is Pathways</h2>\n<p>Pathways is a sequence of steps that guide the tactician while developing a specific tactic</p>\n\n<h2>Why Pathways?</h2>\n<ul>\n  <li><strong>Empower</strong> the log tactician to give the best environment of care to our beneficiaries and our medical team activities.</li>\n  <li><strong>Reduce</strong> the gap between the experienced and novice log tacticians and allows qualitative solution within the operational framework.</li>\n</ul>\n\n<h2>When should I use it?</h2>\n<p>Starting a new project or when circumstances in the project have changed</p>\n\n<iframe src="https://player.vimeo.com/video/220484367" width="465" height="262" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'},useData:!0}),this.BestForMe.Templates["tutorials/pages/tactical-example"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"<h1>Tactical specification Example</h1>\n<h2>Jackie in South-Sudan, Step 2: Tactical Specifications</h2>\n<h2>Tactical Family/ Activity Name:</h2>\n<p>As the type of facility is an out-patient department inside a health facility and as this is not an emergency, Jackie is selecting the <strong>Out-patient activities</strong> and the health facility (for memory, not mandatory) as tactical families.</p>\n<p>As the PMR told her, she has to build 2 new consultation rooms and foresee a space for vaccination, she is writing <strong>extension of the consultation rooms and vaccination.</strong> As the PMR told her (for the support services parameters), she has to implement as well a dispensary, a waiting area and additional latrines. She is filling a second tactical specifications guide for these additional operational needs.</p>\n<h2>Solution requirements:</h2>\n<p>As there is not much space available and the OPD is part of a bigger system (health facilities), Jackie is writing down that the solution must be <strong>integrated in a master plan</strong> to have a vision of future extension possibilities.</p>\n<p>As there are quite a lot of supportive services to implement, together with the 2 consultations, this does not leave much space left. In addition, culturally we should foresee gender separation therefore, she is writing the solution must fulfil a <strong>studied flow of staff and patients.</strong></p>\n<p>As the area can be flooded, Jackie is writing down the solution <strong>should be elevated.</strong> As the number of consultations may increase in the future. Jackie is writing <strong>Modular (possibility of extension).</strong> As it is not allowed by the owner of the compound, Jackie is writing <strong>without foundations.</strong></p>\n<p>As the project will be running for 2 more years, Jackie is writing the <strong>solution should stay good for 2 years and more.</strong></p>\n<p>It is a rural area, the roads are not in a good condition, the security on the roads is not good either, and during the rainy season the roads are not accessible anymore. Jackie is therefore writing down <strong>the solution should not depend on road access.</strong> As there is not much material for construction, Jackie is writing, <strong>material to be mostly imported.</strong></p>\n<h2>What Technical Families are implicated?</h2>\n<p>As it is requested to extend the consultation room, Jackie is selecting <strong>Infrastructures.</strong></p>\n<p>As she should work on the location of the new services based on the flow of the staff and the patient, but as well because a new extension may be requested later on, she is writing, <strong>HFM.</strong></p>\n<p>As water will be needed in the consultation and light, she is writing <strong>Watsan</strong> (plumbing) and <strong>Energy</strong> (electricity).</p>\n<p>As she has to implement vaccination activity, she is writing down <strong>Cold Chain.</strong></p>\n<h2>Other departments implicated:</h2>\n<p>As she has only one log tech in her team and she is not a specialist in construction herself, she is preparing a job description to <strong>recruit a constructor.</strong></p>\n<p>As there is not much material available for construction locally, she will request some support from the supply coordinator to organize the <strong>supply chain of the construction material</strong> on time.</p>\n<p>Role of external stakeholder: She is not sure, but there is another organization that has a machine forming mud bricks, perhaps she will need it, so she is writing down, ask if the machine could be available.</p>"},useData:!0}),this.BestForMe.Templates["tutorials/pages/tactical-tutorial"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return"<h1>Tactical specification Tutorial</h1>\n\n<h2>Highly contagious disease outbreaks</h2>\n<p>Deployment and support of activities tackling diseases, which require to be contained with universal protection for patients and staff over the ordinary measures, with an imposed limited timeframe</p>\n<h2>Distributions</h2>\n<p>Deployment and support of activities aiming at immunization (preventive and curative), water access, shelter items and/or NFI distribution (protection, primary needs) for population coverage within a predefined execution timeframe </p>\n<h2>Medical activities in emergency</h2>\n<p>Deployment and support of first aid and primary needs activities with an imposed limited timeframe for implementation</p>\n<h2>Surgical activities in emergency</h2>\n<p>Deployment and support of surgical activities, with an imposed limited timeframe for implementation</p>\n<h2>Health facilities</h2>\n<p>Deployment and support of permanent hospitalization facilities with multiple services</p>\n<h2>Mobile medical activities</h2>\n<p>Deployment and support activities that imply a movement of staff and material aiming at reaching the beneficiaries in the place of need</p>\n <h2>Out-patient department activities</h2>\n<p>Deployment and support of ambulatory care activities aiming at population coverage</p>\n<h2>Vertical IPD activities</h2>\n<p>Deployment and support of specialized hospitalization facilities aiming at treating a specific disease</p>\n<h2>Medical activities in restricted area</h2>\n <p>Deployment and support of public health activities and/or consultations inside areas with controlled access or movement</p>"},useData:!0}),this.BestForMe.Templates["tutorials/tutorial-view"]=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<section class="page-tutorial cbp-spmenu cbp-spmenu-vertical cbp-spmenu-left" id="cbp-spmenu-s1">\n  <h1>Tutorial</h1>\n  <ul id="header-nav">\n      <li class="main-nav-item btn">\n        <a id=\'tutorial-link\' class="main-nav-link">\n          <span class="main-nav-link-title">Tutorial</span>\n        </a>\n      </li>\n    <li class="main-nav-item btn">\n      <a id=\'example-link\' class="main-nav-link">\n        <span class="main-nav-link-title">Example</span>\n      </a>\n    </li>\n  </ul>\n\n  <section id="page-tutorial">\n\n  </section>\n\n  <section id="page-example">\n\n  </section>\n\n  <div class="close-button">\n    <button id="close-tutorial" class="button"></button>\n  </div>\n</section>'},useData:!0}),BestForMe.Authentification=Backbone.Marionette.Object.extend({authData:null,appData:null,acquireTokenHeaderWithClientCredentials:null,acquireTokenHeaderContentTypeOnly:null,authChannel:null,dataChannel:null,rememberMe:!1,initialAuthCompleted:!1,tokenUpdateInProgress:!1,syncedStorageManager:null,passwordResetRequest:null,passwordReset:null,initialize:function(a){this.authData=a.authData,this.appData=a.appData,this.authChannel=Backbone.Radio.channel("auth"),this.listenTo(this.authChannel,"user:login",this.onUserLogin),this.listenTo(this.authChannel,"request:token:update",this.onTokenUpdateRequested),this.listenTo(this.authChannel,"request:password:reset",this.onRequestPasswordReset),this.listenTo(this.authChannel,"reset:password",this.onResetPassword),this.listenTo(this.authChannel,"change:password",this.onChangePassword),this.dataChannel=Backbone.Radio.channel("data"),this.listenTo(this.dataChannel,"data:fetch:error",this.onDataFetchError),this.initAcquireTokenHeader(),this.initToken(),this.initSyncedStorageManager()},initAcquireTokenHeader:function(){var a=window.btoa(this.authData.clientCredentials.get("clientId")+":"+this.authData.clientCredentials.get("clientSecret"));this.acquireTokenHeaderWithClientCredentials={Authorization:"Basic "+a,"Content-Type":"application/x-www-form-urlencoded"},this.acquireTokenHeaderContentTypeOnly={"Content-Type":"application/x-www-form-urlencoded"}},initToken:function(){this.appData.token=new BestForMe.Token(null,{url:this.authData.tokenEndpoint})},clearLoginAndToken:function(){console.log("Authentification.clearLoginAndToken rememberMe: "+this.rememberMe),this.authData.login.clear(),this.appData.token.clear(),this.appData.tokenBearerHeader=null,this.rememberMe&&(this.rememberMe=!1),this.syncedStorageManager.deleteData("token")},clearTemporararyToken:function(){this.appData.token.clear(),this.appData.tokenBearerHeader=null},initSyncedStorageManager:function(){this.syncedStorageManager=new BestForMe.LocalStoreManager;var a=this,b=function(b){a.onSyncedStorageSet(b)};window.addEventListener("sessionStorageSet",b,!1);var c=function(b){a.onSyncedStorageDeleted(b)};window.addEventListener("storage",c,!1),this.syncedStorageManager.initialiseStorageSyncListener()},onBeforeDestroy:function(){window.removeEventListener("sessionStorageSet",onSyncedStorageSet,!1),window.removeEventListener("storage",onSyncedStorageDeleted,!1)},start:function(){this.getTokenFromLocalStorage()},onSyncedStorageSet:function(a){console.log("TRIGGERED Authentification.onSyncedStorageSet: "+JSON.stringify(a.detail)),!this.initialAuthCompleted&&_.indexOf(a.detail,"token")>-1&&(console.log("ACTED ON Authentification.onSyncedStorageSet: "+JSON.stringify(a.detail)),this.getTokenFromLocalStorage())},onSyncedStorageDeleted:function(a){this.initialAuthCompleted&&"removeFromSessionStorage"===a.key&&null===a.newValue&&"token"===a.oldValue&&(console.log("Authentification.onSyncedStorageDeleted: "+a.key+" "+a.oldValue),this.authChannel.trigger("log:out"))},getTokenFromLocalStorage:function(){console.log("Authentification.getTokenFromLocalStorage");var a=this.syncedStorageManager.getData("token");console.log("TOKEN FETCHED FROM LOCAL STORE"),console.log(a),a?(this.appData.token.set(JSON.parse(a)),this.rememberMe=!0,this.appData.token.isValid()?(console.log("Authentification.tokenFetchSuccessFomLocalStorage VALID model: "+JSON.stringify(this.appData.token)),this.completeAuthentification()):(console.log("Authentification.tokenFetchSuccessFomLocalStorage INVALID REFRESH model: "+JSON.stringify(this.appData.token)),this.requestTokenFomServer("refresh",this.appData.token))):this.authChannel.trigger("login:required")},onUserLogin:function(a){console.log("Authentification.onUserLogin username: "+this.authData.login.get("username")+", password : "+this.authData.login.get("password")+" rememberMe: "+a),this.rememberMe=a,this.requestTokenFomServer("password")},onTokenUpdateRequested:function(){console.log("Authentification.onTokenUpdateRequested tokenUpdateInProgress: "+this.tokenUpdateInProgress),this.tokenUpdateInProgress||(this.tokenUpdateInProgress=!0,this.requestTokenFomServer("refresh",this.appData.token))},requestTokenFomServer:function(a,b){console.log("Authentification.requestTokenFomServer requestType: "+a+", token : "+b);var c=this,d="",e=null;if("password"===a){var f=encodeURIComponent(this.authData.login.get("username")),g=encodeURIComponent(this.authData.login.get("password"));d="grant_type=password&username="+f+"&password="+g,e=c.acquireTokenHeaderWithClientCredentials}else"clientCredentials"===a?(d="grant_type=client_credentials&client_id="+this.authData.clientCredentials.get("clientId")+"&client_secret="+this.authData.clientCredentials.get("clientSecret"),e=c.acquireTokenHeaderContentTypeOnly):"refresh"===a?null===b||void 0===b?console.log("ERROR authentification.requestTokenFomServer TRYING TO REFRESH A TOKEN of type: "+b):(d="grant_type=refresh_token&refresh_token="+b.get("refreshToken")+"&client_id="+this.authData.clientCredentials.get("clientId")+"&client_secret="+this.authData.clientCredentials.get("clientSecret"),e=c.acquireTokenHeaderContentTypeOnly):console.log("ERROR authentification.requestTokenFomServer INVALID REQUEST TYPE: "+a);this.appData.token.fetch({ajaxSync:!0,success:function(d,e,f){c.tokenFetchSuccessFomServer(d,e,f,a,b)},error:function(d,e,f){c.tokenFetchErrorFomServer(d,e,f,a,b)},method:"POST",headers:e,data:d})},tokenFetchSuccessFomServer:function(a,b,c,d,e){if(console.log("Authentification.tokenFetchSuccessFomServer requestType: "+d+" model: "+JSON.stringify(a)+", response: "+JSON.stringify(b)),"password"===d||"refresh"===d){var f=JSON.stringify(this.appData.token.toJSON());console.log(f),this.rememberMe?this.syncedStorageManager.savePermanentData(f,"token"):this.syncedStorageManager.saveSyncedSessionData(f,"token"),this.completeAuthentification()}else"clientCredentials"===d&&(this.appData.tokenBearerHeader={Authorization:"Bearer "+this.appData.token.get("accessToken")},this.passwordResetRequest?this.requestPasswordReset():this.passwordReset&&this.resetPassword())},tokenFetchErrorFomServer:function(a,b,c,d,e){console.log("Authentification.tokenFetchErrorFomServer requestType: "+d+" model: "+JSON.stringify(a)+", response: "+JSON.stringify(b)+", options: "+JSON.stringify(c));var f=this.handleError(b,c,!1);this.clearLoginAndToken(),this.authChannel.trigger("login:invalid",f.errorMessage)},completeAuthentification:function(){this.appData.tokenBearerHeader={Authorization:"Bearer "+this.appData.token.get("accessToken")},console.log(this.appData.tokenBearerHeader),this.initialAuthCompleted?(this.tokenUpdateInProgress=!1,this.authChannel.trigger("token:updated")):(this.initialAuthCompleted=!0,this.authChannel.trigger("authentification:complete"))},onDataFetchError:function(a){console.log("Authentification.onDataFetchError: "+JSON.stringify(a)),"login"===a.action&&this.clearLoginAndToken()},onLogOut:function(){console.log("Authentification.onLogOut"),this.clearLoginAndToken(),this.initialAuthCompleted=!1},onRequestPasswordReset:function(a){console.log("Authentification.onResetPassword username: "+a),this.passwordResetRequest=new BestForMe.PasswordResetRequest({identifier:a},{userBaseUrl:this.authData.userEndpoint}),this.requestTokenFomServer("clientCredentials")},requestPasswordReset:function(){var a=this;this.passwordResetRequest.save(null,{headers:this.appData.tokenBearerHeader,success:function(b,c,d){a.requestPasswordResetSuccess(b,c,d)},error:function(b,c,d){a.requestPasswordResetError(b,c,d)}})},requestPasswordResetSuccess:function(a,b,c){console.log("Authentification.passwordResetSuccess MODEL "+JSON.stringify(a)),console.log("Authentification.passwordResetSuccess RESPONSE "+JSON.stringify(b)),this.passwordResetRequest=null,this.clearTemporararyToken(),swal("Success","An email has been sent to the email address associated with your username. Please follow the instructions to reset your password and log in with the new password."),this.authChannel.trigger("request:password:reset:success")},requestPasswordResetError:function(a,b,c){console.log("Authentification.passwordResetError MODEL "+JSON.stringify(a)),console.log("Authentification.passwordResetError RESPONSE "+JSON.stringify(b)),this.passwordResetRequest=null,this.clearTemporararyToken();var d=this.handleError(b,c,!1);swal(errorMessage),this.authChannel.trigger("request:password:reset:error",d.errorMessage)},onResetPassword:function(a){return this.authData.passwordReset&&this.authData.passwordReset.username&&this.authData.passwordReset.key?(this.passwordReset=new BestForMe.PasswordReset({password:a,username:this.authData.passwordReset.username.replace("+"," "),resetKey:this.authData.passwordReset.key},{url:this.authData.passwordEndpoint}),void this.requestTokenFomServer("clientCredentials")):void swal({title:"The password reset link is invalid or incomplete. Please check the link in the email you received, or request a new one using the 'Forgotten Password?' link.",showCancelButton:!1,confirmButtonText:"OK",closeOnConfirm:!0},function(){var a=Backbone.Radio.channel("router");a.trigger("navigate:to:page","login")})},resetPassword:function(a){var b=this;this.passwordReset.save(null,{headers:this.appData.tokenBearerHeader,success:function(a,c,d){b.resetPasswordSuccess(a,c,d)},error:function(a,c,d){b.resetPasswordError(a,c,d)}})},resetPasswordSuccess:function(){this.authData.passwordReset=null,this.passwordReset=null,this.clearTemporararyToken(),swal({title:"Your password has been changed successfully. Please log in.",showCancelButton:!1,confirmButtonText:"OK",closeOnConfirm:!0},function(){var a=Backbone.Radio.channel("auth");a.trigger("password:reset:clear:redirect")})},resetPasswordError:function(){this.authData.passwordReset=null,this.passwordReset=null,
this.clearTemporararyToken(),swal({title:"An error occurred changing your password. Most likely the change password link was no longer valid. Please request a new one using the 'Forgotten Password?' link.",showCancelButton:!1,confirmButtonText:"OK",closeOnConfirm:!0},function(){var a=Backbone.Radio.channel("auth");a.trigger("password:reset:clear:redirect")})},onChangePassword:function(a){var b=new BestForMe.PasswordChange({oldPassword:a.oldPassword,password:a.password},{url:this.authData.passwordEndpoint}),c=this;b.save(null,{headers:this.appData.tokenBearerHeader,success:function(a,b,d){c.changePasswordSuccess(a,b,d)},error:function(a,b,d){c.changePasswordError(a,b,d)}})},changePasswordSuccess:function(){swal({title:"Your password has been changed successfully",showCancelButton:!1,confirmButtonText:"OK",closeOnConfirm:!0},function(){var a=Backbone.Radio.channel("router");a.trigger("navigate:to:page","home")})},changePasswordError:function(){swal("An error occurred changing your password, please ensure you details are correct and try again")}}),_.extend(BestForMe.Authentification.prototype,BestForMe.ErrorHandlerMixin),BestForMe.Router=Backbone.Marionette.AppRouter.extend({appRoutes:{"loading(/)":"showLoadingScreen","home(/)":"showHomeScreen","(/)":"showHomeScreen","error(/)(:errorCode)":"showErrorScreen","parameter-guide/:projectId":"showParameterScreen","tactical-specification/:projectId":"showTacticalScreen","agility-matrix/:projectId/:operationalNeedId":"showSolutionScreen","technical-solution-library/:projectId/:operationalNeedId":"showSolutionScreen","tactical-canvas/:projectId/:operationalNeedId":"showCanvasScreen","final-tactic/:projectId/:operationalNeedId":"showTacticScreen","export-parameters/:projectId":"showParameterExport","export-operational-need/:projectId":"showOperationalNeedExport","export-final-tactic/:projectId/:operationalNeedId":"showFinalTacticExport","pagenotfound(/)":"showPageNotFound","*path":"showPageNotFound"},appDataFetched:!1,routesAllowedBeforeDataFetched:["showLoadingScreen","showErrorScreen","showPageNotFound"],routerChannel:null,allowBlockedRoute:!1,blockedRoute:null,appData:null,smartHistory:{previousPage:null,currentPage:null},initialize:function(a){this.appData=a.appData,this.smartHistory.previousPage=this.appData.rootHomePage,this.routerChannel=Backbone.Radio.channel("router"),this.listenTo(this.routerChannel,"server:down",this.onServerDown),this.listenTo(this.routerChannel,"go:back",this.goBack)},onDataFetched:function(){console.log("Router.onDataFetched ADD DATA FETCHED!!!!"),this.appDataFetched=!0},onServerDown:function(){if(console.log("App.onServerDown, blockedRoute: "+JSON.stringify(this.blockedRoute)),this.allowBlockedRoute=!0,this.blockedRoute){var a=this.routeUrlFromRouteMethod(this.blockedRoute.name,this.blockedRoute.args);this.navigate(a,{trigger:!0}),this.blockedRoute=null}else this.navigate(this.appData.rootHomePage,{trigger:!0})},execute:function(a,b,c,d){if(console.log("Router.execute name: "+c+", args: "+JSON.stringify(b)+", allowBlockedRoute: "+this.allowBlockedRoute),this.appDataFetched)this.blockedRoute&&(this.blockedRoute=null);else{for(var e=!1,f=0;f<this.routesAllowedBeforeDataFetched.length;f++)if(c.match(this.routesAllowedBeforeDataFetched[f])){e=!0,console.log("Router.execute ROUTE ALLOWED BEFORE DATA FETCHED!!!! name: "+c);break}if(!e&&!this.allowBlockedRoute)return console.log("Router.execute  NO DATA CANCEL ROUTE!!!! name: "+c),this.blockedRoute={},this.blockedRoute.args=b,this.blockedRoute.name=c,!1;!e&&this.allowBlockedRoute&&(this.allowBlockedRoute=!1)}a&&a.apply(this,b)},onRoute:function(a,b,c){$(document).scrollTop(0),console.log("Router.onRoute name: "+a+", path: "+b+", args: "+JSON.stringify(c));var d=this.routeUrlFromRouteMethod(a,c);b.match(/loading/)||b.match(/login/)||(this.smartHistory.currentPage&&(this.smartHistory.previousPage=this.smartHistory.currentPage),this.smartHistory.currentPage=d);var e=this.routeRegexpFromRouteMethod(a,c);this.routerChannel.trigger("route:executed",e)},routeRegexpFromRouteMethod:function(a,b){var c="";"showLoadingScreen"===a?c="loading":"showHomeScreen"===a?c="home":"showErrorScreen"===a?(c="error",b[0]&&(c+="/"+b[0])):"showPageNotFound"===a&&(c="pagenotfound");var d=new RegExp(c,"i");return d},routeUrlFromRouteMethod:function(a,b){var c="";return"showLoadingScreen"===a?c="loading":"showHomeScreen"===a?c="home":"showErrorScreen"===a?(c="error",b[0]&&(c+="/"+b[0])):"showPageNotFound"===a&&(c="pagenotfound"),c}}),BestForMe.RouterController=Backbone.Marionette.Object.extend({authData:null,appData:null,appLayoutRendered:!1,loginScreenShown:!1,routerChannel:null,initialize:function(a){this.authData=a.authData,this.appData=a.appData,this.routerChannel=Backbone.Radio.channel("router"),this.appLayout=new BestForMe.AppLayout({appData:this.appData}),this.loginScreen=new BestForMe.LoginScreen({model:this.authData.login,title:this.appData.title})},showLoginScreen:function(){this.appLayoutRendered=!1,console.log("RouterController.showLoginScreen"),this.loginScreenShown=!0,this.loginScreen.render()},forceInitialRender:function(){return console.log("RouterController.forceInitialRender: AppLayout already rendered? "+this.appLayoutRendered),this.appLayoutRendered?void console.log("RouterController.forceInitialRender: SPECIAL BYPASS CASE, APPLAYOUT ALREADY RENDERED"):(this.loginScreenShown&&(this.loginScreen.navigateAway(),this.loginScreenShown=!1),this.appLayoutRendered=!0,void this.appLayout.render())},checkAppLayoutRendered:function(){this.appLayoutRendered||this.forceInitialRender()},showLoadingScreen:function(){console.log("RouterController.showLoadingScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showLoadingScreen()},showErrorScreen:function(a){console.log("RouterController.showErrorScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showErrorScreen(a)},showPageNotFound:function(){console.log("RouterController.showPageNotFound: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showErrorScreen(404)},showHomeScreen:function(){console.log("RouterController.showHomeScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showHomeScreen()},showParameterScreen:function(a){console.log("RouterController.showParameterScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showParameterScreen(a)},showTacticalScreen:function(a){console.log("RouterController.showTacticalScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showTacticalScreen(a)},showSolutionScreen:function(a,b){console.log("RouterController.showSolutionScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showSolutionScreen(a,b)},showCanvasScreen:function(a,b){console.log("RouterController.showCanvasScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showCanvasScreen(a,b)},showTacticScreen:function(a,b){console.log("RouterController.showTacticScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showTacticScreen(a,b)},showParameterExport:function(a){console.log("RouterController.showParameterExportScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showParameterExport(a)},showOperationalNeedExport:function(a){console.log("RouterController.showOperationalExportScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showOperationalNeedExport(a)},showFinalTacticExport:function(a,b){console.log("RouterController.showFinalExportScreen: AppLayout already rendered? "+this.appLayoutRendered),this.checkAppLayoutRendered(),this.appLayout.showFinalTacticExport(a,b)}}),BestForMe.DataManager=Backbone.Marionette.Object.extend({appData:null,dataChannel:null,coreDataFetched:!1,errorHandlingInProgress:!1,pathwaysDataManager:null,pathwaysCoreDataFetched:!1,initialize:function(a){this.appData=a.appData,this.dataChannel=Backbone.Radio.channel("data"),this.listenTo(this.dataChannel,"pathways:core:data:fetched",this.onPathwaysCoreDataFetched),this.initData()},initData:function(){this.appData.modules.pathways&&(this.pathwaysDataManager=new BestForMe.PathwaysDataManager({appData:this.appData}))},clearData:function(){console.log("DataManager.clearData"),this.coreDataFetched=!1,this.appData.modules.pathways&&(this.pathwaysDataManager.clearData(),this.pathwaysCoreDataFetched=!1)},fetchData:function(){console.log("DataManager.fetchData : GETTING DATA FROM SERVER NOW!"),this.errorHandlingInProgress=!1;this.appData.modules.pathways&&this.pathwaysDataManager.fetchModuleCoreData()},dataFetchSuccess:function(a,b,c,d){console.log("DataManager.dataFetchSuccess: "+d),this.coreDataFetched||this.checkCoreDataFetched()},dataFetchError:function(a,b,c,d){console.log("DataManager.dataFetchError: "+d+", error handling in progress: "+this.errorHandlingInProgress);var e="statistics"===d||"dock"===d||"footer"===d;if(e){var f=this.handleError(b,c,!1);this.dataChannel.trigger("missing:data",d)}else if(!this.errorHandlingInProgress){this.errorHandlingInProgress=!0;var f=this.handleError(b,c,!0);"message"!==f.action||500!==f.errorCode&&503!==f.errorCode&&504!==f.errorCode&&0!==f.errorCode||this.dataChannel.trigger("data:fetch:error",f)}},onPathwaysCoreDataFetched:function(){console.log("DataManager.onPathwaysCoreDataFetched"),this.pathwaysCoreDataFetched=!0,this.coreDataFetched||this.checkCoreDataFetched()},checkCoreDataFetched:function(){this.pathwaysCoreDataFetched===!0&&(this.coreDataFetched=!0,this.dataChannel.trigger("data:fetched"))}}),_.extend(BestForMe.DataManager.prototype,BestForMe.ErrorHandlerMixin),BestForMe.AppLayout=Backbone.Marionette.LayoutView.extend({el:"#bestForMe-app",template:BestForMe.Templates["app-layout"],ui:{uiHeader:"#header",uiMain:"#main"},regions:{header:"#header",main:"#main",tutorial:"#tutorial",footer:"#footer"},childEvents:{"reset:app:layout":"resetAppLayout"},appData:null,initialize:function(a){this.appData=a.appData},onRender:function(){console.log("AppLayout.onRender: "+this.isRendered);var a=new BestForMe.HeaderView({appData:this.appData});this.showChildView("header",a);var b=new BestForMe.FooterView({appData:this.appData});this.showChildView("footer",b);var c=new BestForMe.TutorialView({appData:this.appData});this.showChildView("tutorial",c)},showLoadingScreen:function(){console.log("AppLayout.showLoadingScreen: "+this.isRendered);var a=new BestForMe.LoadingScreen;this.showChildView("main",a)},showErrorScreen:function(a){console.log("AppLayout.showErrorScreen: "+a+" "+this.isRendered);var b=new BestForMe.ErrorScreen({appData:this.appData,errorCode:a});this.showChildView("main",b)},showHomeScreen:function(){console.log("AppLayout.showHomeScreen: "+this.isRendered);var a=new BestForMe.ProjectListView({appData:this.appData,collection:this.appData.data.pathways.projects});this.showChildView("main",a)},showParameterScreen:function(a){console.log("AppLayout.showParameterScreen for project: "+a+" "+this.isRendered);var b=new BestForMe.ParameterView({appData:this.appData,projectId:a});this.showChildView("main",b)},showTacticalScreen:function(a){console.log("AppLayout.showTacticalScreen for project: "+a+" "+this.isRendered);var b=new BestForMe.TacticalView({appData:this.appData,projectId:a});this.showChildView("main",b)},showSolutionScreen:function(a,b){console.log("AppLayout.showSolutionScreen for project: "+a+" "+this.isRendered);var c=new BestForMe.SolutionView({appData:this.appData,projectId:a,operationalNeedId:b});this.showChildView("main",c)},showCanvasScreen:function(a,b){console.log("AppLayout.showCanvasScreen for project: "+a+" "+this.isRendered);var c=new BestForMe.CanvasView({appData:this.appData,projectId:a,operationalNeedId:b});this.showChildView("main",c)},showTacticScreen:function(a,b){console.log("AppLayout.showTacticScreen for project: "+a+" "+this.isRendered);var c=new BestForMe.TacticView({appData:this.appData,projectId:a,operationalNeedId:b});this.showChildView("main",c)},showParameterExport:function(a){console.log("AppLayout.showExportScreen for project: "+a+" "+this.isRendered);var b=new BestForMe.ParameterExport({appData:this.appData,projectId:a});this.showChildView("main",b)},showOperationalNeedExport:function(a){console.log("AppLayout.showExportScreen for project: "+a+" "+this.isRendered);var b=new BestForMe.OperationalNeedExport({appData:this.appData,projectId:a});this.showChildView("main",b)},showFinalTacticExport:function(a,b){console.log("AppLayout.showExportScreen for project: "+a+" "+this.isRendered);var c=new BestForMe.FinalTacticExport({appData:this.appData,projectId:a,operationalNeedId:b});this.showChildView("main",c)},resetAppLayout:function(){this.ui.uiHeader.css("margin-top","0"),this.ui.uiMain.css("padding-top","211px")}}),BestForMe.LoginScreen=Backbone.Marionette.ItemView.extend({el:"#bestForMe-app",template:BestForMe.Templates["login-screen"],ui:{username:".login-username",password:".login-password",rememberMe:".login-save-checkbox",loginLabel:".login-save-prompt",submit:".login-submit",resetPassword:".login-reset-password"},events:{"click @ui.submit":"submitLogin","click @ui.resetPassword":"resetPassword","click @ui.loginLabel":"toggleRememberMe","keypress @ui.username":"processKey","keypress @ui.password":"processKey"},authChannel:null,bodyEl:null,title:null,initialize:function(a){this.title=a.title,this.authChannel=Backbone.Radio.channel("auth"),this.listenTo(this.authChannel,"login:invalid",this.onLoginInvalid),this.listenTo(this.authChannel,"request:password:reset:success",this.render),this.listenTo(this.authChannel,"request:password:reset:error",this.render),this.bodyEl=document.getElementsByTagName("BODY")[0]},onRender:function(){console.log("LoginScreen.onRender"),this.bodyEl.classList.add("login-bg")},navigateAway:function(){console.log("LoginScreen.navigateAway"),this.bodyEl.classList.remove("login-bg")},processKey:function(a){13===a.which&&this.submitLogin()},submitLogin:function(){var a=this.ui.username.val(),b=this.ui.password.val(),c=this.ui.rememberMe[0].checked;""===a?alert("Please enter a valid username."):""===b?alert("Please enter a valid password."):(console.log("LoginScreen.submitLogin LOGIN SAVED username: "+a+", password: "+b+", Stay Logged in?: "+c),this.model.set({username:a,password:b}),this.authChannel.trigger("user:login",c))},resetPassword:function(){var a=this.ui.username.val(),b=this;swal({title:"Forgotten Password?",text:"Please enter your username to reset your password.",type:"input",showCancelButton:!0,closeOnConfirm:!1,inputPlaceholder:"Username",inputValue:this.ui.username.val(),closeOnConfirm:!0},function(c){return c!==!1&&(""===c?(swal.showInputError("Please enter your username"),!1):(a=c,console.log(c),void b.authChannel.trigger("request:password:reset",a)))})},toggleRememberMe:function(){this.ui.rememberMe[0].checked?this.ui.rememberMe[0].checked=!1:this.ui.rememberMe[0].checked=!0},onLoginInvalid:function(a){console.log("LoginScreen.onLoginInvalid : "+a),this.model.clear(),swal(a),this.render()},onRender:function(){this.title&&this.changePageTitle(this.title,"Login")}}),_.extend(BestForMe.LoginScreen.prototype,BestForMe.ChangeTitleMixin),BestForMe.LoadingScreen=Backbone.Marionette.ItemView.extend({template:BestForMe.Templates["loading-screen"],routerChannel:null,serverTimeout:null,serverTimeoutDelay:15e3,initialize:function(a){this.routerChannel=Backbone.Radio.channel("router")},onRender:function(){var a=this;this.serverTimeout=setTimeout(function(){a.onServerTimeout(a)},a.serverTimeoutDelay)},onDestroy:function(){clearTimeout(this.serverTimeout)},onServerTimeout:function(a){console.log("LoadingScreen.onServerTimeout"),clearTimeout(a.serverTimeout),this.routerChannel.trigger("server:down")}}),BestForMe.ErrorScreen=Backbone.Marionette.ItemView.extend({template:BestForMe.Templates["error-screen"],appData:null,errorCode:0,errorMessage:"",initialize:function(a){this.appData=a.appData,a.errorCode&&(this.errorCode=a.errorCode),this.errorMessage=this.appData.errorMessage[this.errorCode]},templateHelpers:function(){return{message:this.errorMessage}}}),BestForMe.HeaderView=Backbone.Marionette.LayoutView.extend({template:BestForMe.Templates.header,home:"/home",ui:{headerNav:"#header-nav",agilityNav:"#agility-nav"},behaviors:{removeTemplateWrapperBehavior:{behaviorClass:BestForMe.RemoveTemplateWrapperBehavior},internalLinkBehavior:{behaviorClass:BestForMe.InternalLinkBehavior}},uiChannel:null,activePage:null,appData:null,projectId:null,projectTitle:null,operationalNeedId:null,operationalNeedTitle:null,showNav:!1,showAgilityNav:!1,navCollection:new Backbone.Collection([{title:"Parameter Guide",link:"/parameter-guide",active:!0,hasOperationalNeedParam:!1},{title:"Tactical Specification",link:"/tactical-specification",active:!1,hasOperationalNeedParam:!1},{title:"Agility Matrix",link:"/agility-matrix",active:!1,hasOperationalNeedParam:!0}]),agilityCollection:new Backbone.Collection([{title:"Technical Solution Library",link:"/technical-solution-library",active:!0,hasOperationalNeedParam:!0},{title:"Tactical Canvas",link:"/tactical-canvas",active:!1,hasOperationalNeedParam:!0},{title:"Final Tactic",link:"/final-tactic",active:!1,hasOperationalNeedParam:!0}]),initialize:function(a){this.appData=a.appData,this.uiChannel=Backbone.Radio.channel("ui"),this.listenTo(this.uiChannel,"update:nav",this.updateNav)},templateHelpers:function(){var a=window.location.origin;return{home:this.home,origin:a,agility:this.agilityCollection,nav:this.navCollection,projectId:this.projectId,projectTitle:this.projectTitle,operationalNeedId:this.operationalNeedId,operationalNeedTitle:this.operationalNeedTitle,showNav:this.showNav,showAgilityNav:this.showAgilityNav}},updateNav:function(a){var b=document.location.href.split("/");if(b="/"+b[3],a.showAgilityNav){this.navCollection.each(function(a){a.set("active",!1)});var c=this.navCollection.where({link:"/agility-matrix"})[0];c.set("active",!0),this.agilityCollection.each(function(a){a.set("active",!1)});var d="";d="/agility-matrix"===b?this.agilityCollection.where({link:"/technical-solution-library"})[0]:this.agilityCollection.where({link:b})[0],d.set("active",!0)}else if(a.showNav){this.navCollection.each(function(a){a.set("active",!1)});var e=this.navCollection.where({link:b})[0];e.set("active",!0)}this.projectId=a.projectId,this.projectId?this.projectTitle=this.appData.data.pathways.projects.at(this.projectId-1).get("name"):this.projectTitle=null,this.operationalNeedId=a.operationalNeedId,this.operationalNeedId?this.operationalNeedTitle=this.appData.data.pathways.projects.at(this.projectId-1).get("operationalNeeds").at(this.operationalNeedId-1).get("name"):(this.operationalNeedId=1,this.operationalNeedTitle=null),this.showNav=a.showNav,this.showAgilityNav=a.showAgilityNav,this.render()}}),BestForMe.FooterView=Backbone.Marionette.LayoutView.extend({template:BestForMe.Templates["footer/footer"],behaviors:{removeTemplateWrapperBehavior:{behaviorClass:BestForMe.RemoveTemplateWrapperBehavior}},ui:{footerContainer:".footer",tutorialButton:"#show-tutorial",saveButton:".save-button",exportButton:".export-button"},events:{"click @ui.tutorialButton":"showTutorial","click @ui.saveButton":"saveNext"},appData:null,uiChannel:null,dataChannel:null,projectId:null,operationalNeedId:null,exportLink:null,showSave:!1,showExport:!1,initialize:function(a){this.appData=a.appData,this.dataChannel=Backbone.Radio.channel("data"),this.uiChannel=Backbone.Radio.channel("ui"),this.listenTo(this.uiChannel,"update:footer",this.updateFooter)},templateHelpers:function(){var a=window.location.origin;return{origin:a,projectId:this.projectId,operationalNeedId:this.operationalNeedId,exportLink:this.exportLink,showSave:this.showSave,showExport:this.showExport}},updateFooter:function(a){this.projectId=a.projectId,this.operationalNeedId=a.operationalNeedId,this.showSave=a.showSave,this.showExport=a.showExport;var b=Backbone.history.fragment;console.log("UPDATE FOOTER: "+b),b.match(/parameter-guide/)?this.exportLink="/export-parameters/":b.match(/tactical-specification/)?this.exportLink="/export-operational-need/":b.match(/final-tactic/)&&(this.exportLink="/export-final-tactic/"),this.render()},showTutorial:function(){this.dataChannel.trigger("show:tutorial")},saveNext:function(){var a=Backbone.history.fragment;console.log("saveNext FOR LOCATION: "+a),a.match(/parameter-guide/)?this.dataChannel.trigger("save:next:parameter"):a.match(/tactical-specification/)?this.dataChannel.trigger("save:next:tactical"):a.match(/agility-matrix/)||a.match(/technical-solution-library/)?this.dataChannel.trigger("save:next:technical:solution:library"):a.match(/tactical-canvas/)?this.dataChannel.trigger("save:next:tactical:canvas"):console.log("saveNext not enabled on current route!!!")}}),$(function(){"use strict";var a={pathwaysEndpoint:{parameter:"/parameter.json",tacticalFamilies:"/tactical-families.json",technicalFamilies:"/technical-families.json"},debug:"true",title:"Pathways",features:{localMode:"true"},modules:{engage:"false",pathways:"true"}},b=new BestForMe(a);b.start()});